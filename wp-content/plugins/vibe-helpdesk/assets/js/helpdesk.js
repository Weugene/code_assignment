(()=>{"use strict";function e(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var n=wp.element,r=(n.createElement,n.useState),o=n.useEffect,a=(n.Fragment,n.render,n.useRef),l=wp.data,c=(l.dispatch,l.select);const u=function(t){var n=function(t,n){return function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,n)||e(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(r(""),2),a=n[0],i=n[1];return o((function(){var e="",n="";switch(t.type){case"friends":n="user",e=t.id.item_id;break;case"group":n="group",e=t.id.item_id;break;case"activity":n="user",e=t.id.secondary_item_id;break;case"member":case"name":case"user_tip":case"user":n="user",e=t.id.user_id;break;default:n=t.type,e=t.id.item_id}localforage.getItem(n+"_"+e).then((function(r){null!==r?i(JSON.parse(r)):fetch("".concat(window.vibebp.api.url,"/avatar"),{method:"post",body:JSON.stringify({type:t.type,ids:t.id,token:c("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){t.name&&(localforage.setItem(n+"_"+e,JSON.stringify(t)),i(t))}))}))}),[]),"member"==t.type?wp.element.createElement("span",{className:"vibebp_member",title:a.name},wp.element.createElement("img",{src:a.avatar,className:"vibebp_avatar",onClick:t.click,alt:a.name,title:a.name}),wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:a.name}})):"user_tip"==t.type?wp.element.createElement("span",{className:"vibebp_member tip",title:a.name},wp.element.createElement("img",{src:a.avatar,className:"vibebp_avatar",onClick:t.click,alt:a.name,title:a.name})):"name"==t.type?wp.element.createElement("span",null,a.name):wp.element.createElement("img",{src:a.avatar,className:"vibebp_avatar",onClick:t.click,alt:a.name,title:a.name})};var s=function(n,r){var i,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c=a(Date.now());o((function(){var e=setTimeout((function(){Date.now()-c.current>=r&&(n(),c.current=Date.now())}),r-(Date.now()-c.current));return function(){clearTimeout(e)}}),[r].concat(function(e){if(Array.isArray(e))return t(e)}(i=l)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||e(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))};function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===p(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}wp.element.createElement;var y=wp.element,w=(y.createElement,y.useState),h=y.Fragment,g=wp.data,E=g.dispatch,O=g.select;const _=function(e){var t=O("vibebp").getUser(),n=window.helpdesk.settings.agents_cap&&t.roles.includes(window.helpdesk.settings.agents_cap),r=b(w(""),2),o=r[0],a=r[1],i=b(w([]),2),l=i[0],c=i[1],u=b(w(null),2),p=u[0],m=u[1],d=b(w(!1),2),v=d[0],y=d[1];return s((function(){p&&p.abort();var e=new AbortController,t=p?{signal:e.signal}:{};m(e),c([]),o&&o.length>2&&(y(!0),fetch("".concat(window.helpdesk.api.url,"/bbp/users/canned-responses?nocache"),f(f({method:"post"},t),{},{body:JSON.stringify({s:o,token:O("vibebp").getToken()})})).then((function(e){return e.json()})).then((function(e){y(!1),e.status&&e.data&&Array.isArray(e.data)&&c(e.data),e.hasOwnProperty("message")&&E("vibebp").addNotification({text:e.message})})).catch((function(e){y(!0)})))}),500,[o]),wp.element.createElement(h,null,n?wp.element.createElement("div",{className:"canned_search_wrapper"},wp.element.createElement("div",{className:"canned_search_wrapper_header"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("input",{type:"text",placeholder:window.helpdesk.translations.search_canned,onChange:function(e){a(e.target.value)},value:o}),wp.element.createElement("span",{class:"vicon vicon-search"})),v?wp.element.createElement("div",{className:"lds-ellipsis"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):""),l&&Array.isArray(l)?wp.element.createElement("div",{className:"canned_responses"},l.map((function(t){return wp.element.createElement("span",{className:"canned_response",onClick:function(){var n=t.post_content,r=t.raw;e.update({post_content:n,raw:r})}},t.post_title)}))):""):"")};function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==j(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===j(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=wp.element,x=(I.createElement,I.useState),C=I.useEffect,T=wp.data,D=T.dispatch,U=T.select;const M=function(e){var t=N(x(e.reply),2),n=t[0],r=t[1],o=N(x({}),2),a=o[0],i=o[1],l=N(x(!1),2),c=l[0],u=l[1],s="vibe_reply_editor_".concat(n.id),p=N(x(0),2),m=p[0],f=(p[1],function(e){i({post_content:e.detail.raw_html,raw:e.detail.editor_content})});return C((function(){var e=new CustomEvent("load_vibe_editor",{detail:{selector:".".concat(s).concat(m),content:n.hasOwnProperty("post_content")&&n.post_content?n.post_content:"",raw:n.hasOwnProperty("raw")&&n.raw?n.raw:"",components:["editor"],updater:"".concat(s).concat(m)}});document.dispatchEvent(e),document.addEventListener("vibe_editor_content_update_".concat(s).concat(m),f)}),[]),wp.element.createElement("div",{id:"new_reply",className:"vibebp_reply_form"},wp.element.createElement(_,{update:function(e){var t,o,l;r(k(k(k({},n),e),{},{id:0})),i(k(k({},a),e)),t=k(k(k({},n),e),{},{id:0}),o=m,l=new CustomEvent("load_vibe_editor",{detail:{selector:".".concat(s).concat(o),content:t.hasOwnProperty("post_content")&&t.post_content?t.post_content:"",raw:t.hasOwnProperty("raw")&&t.raw?t.raw:"",components:["editor"],updater:"".concat(s).concat(o),reinit:Math.random()}}),document.dispatchEvent(l),document.addEventListener("vibe_editor_content_update_".concat(s).concat(o),f)}}),wp.element.createElement("div",{className:"vibe_reply_editor_wrapper"},wp.element.createElement("img",{src:U("vibebp").getUser().avatar,title:U("vibebp").getUser().displayname}),wp.element.createElement("div",{className:"vibe_reply_editor"},wp.element.createElement("div",{className:"".concat(s).concat(m),"data-id":m},wp.element.createElement("textarea",{onChange:function(e){r(k(k({},n),{},{post_content:e.target.value})),i(k(k({},a),{},{post_content:e.target.value}))},value:n.post_content})),wp.element.createElement("div",{className:"vibebp_reply_form_actions"},wp.element.createElement("div",{className:"vibebp_reply_form_buttons"},window.helpdesk.settings.private_plugin_active?wp.element.createElement("div",{className:"vibebp_form_field helpdesk_private_reply"},wp.element.createElement("span",null,window.helpdesk.translations.make_reply_private),wp.element.createElement("div",{className:"switch"},n.hasOwnProperty("is_private")&&n.is_private?wp.element.createElement("input",{type:"checkbox",id:"".concat(s,"_private"),checked:!0,onClick:function(){r(k(k({},n),{},{is_private:!1}))}}):wp.element.createElement("input",{type:"checkbox",id:"".concat(s,"_private"),onClick:function(){r(k(k({},n),{},{is_private:!0}))}}),wp.element.createElement("label",{for:"".concat(s,"_private"),className:"slider"}))):"",wp.element.createElement("a",{className:c?"button is-primary is-loading":"button is-primary",onClick:function(){u(!0),fetch("".concat(window.helpdesk.api.url,"/bbp/replies/create?post"),{method:"post",body:JSON.stringify(k(k({},n),{},{post_content:a.post_content,raw:a.raw,token:U("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(t){u(!1),t.status&&(r(k(k({},n),{},{post_content:"",meta:[]})),e.update&&e.update(t.reply)),t.hasOwnProperty("message")&&D("vibebp").addNotification({text:t.message})}))}},window.helpdesk.translations.post_reply))))))},J=(0,wp.element.createContext)({value:{},update:function(e){}});function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $=wp.element,F=($.createElement,$.useState),H=$.Fragment,q=$.useEffect,B=wp.data,z=B.dispatch,V=B.select;const Y=function(e){var t=L(F({}),2),n=t[0],r=t[1],o=V("vibebp").getUser(),a=L(F(!1),2),i=a[0],l=a[1],c=L(F(!1),2),s=c[0],p=c[1];return q((function(){r(e.reply)}),[e.reply]),n.hasOwnProperty("id")?wp.element.createElement("div",{className:"vibebp_reply"},wp.element.createElement(u,{type:"member",id:{user_id:parseInt(n.author)}}),wp.element.createElement("div",{className:n.hasOwnProperty("is_private")&&n.is_private?"is_private vibebp_reply_content":"vibebp_reply_content"},wp.element.createElement("div",{className:"vibebp_reply_content_meta"},wp.element.createElement("div",null,wp.element.createElement("a",{href:n.permalink,className:"vicon vicon-link"}),wp.element.createElement("span",null,n.last_update)),wp.element.createElement("div",{className:"reply_action"},parseInt(o.id)===parseInt(n.author)?wp.element.createElement(H,null,wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){l(!i)}}),wp.element.createElement("span",{className:s?"vicon vicon-reload":"vicon vicon-trash",onClick:function(){if(n.id){p(!0);var t="?post&args=".concat(encodeURIComponent(JSON.stringify({id:n.id})));fetch("".concat(window.helpdesk.api.url,"/bbp/replies/delete").concat(t),{method:"post",body:JSON.stringify({reply_id:n.id,token:V("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){t.status&&(p(!1),e.delete&&e.delete()),t.hasOwnProperty("message")&&z("vibebp").addNotification({text:t.message})})).catch((function(e){p(!1)}))}}})):"")),n.attachments.length?wp.element.createElement("div",{className:"vibebp_reply_attachments"},n.attachments.map((function(e){return wp.element.createElement("div",{className:"vibebp_reply_attachment"},"image"==e.key?wp.element.createElement("a",{href:e.value,target:"_blank"},wp.element.createElement("img",{src:e.value})):wp.element.createElement("a",{href:e.value,target:"_blank",className:"vicon vicon-link"}))}))):"",i?wp.element.createElement("div",{className:"update_reply_container"},wp.element.createElement(M,{reply:n,update:function(e){l(!1),r(e),document.dispatchEvent(new Event("VibeBP_Editor_Content"))}})):wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:n.post_content}}))):""};function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==K(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===K(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Q=wp.element,W=(Q.createElement,Q.render,Q.useState),ee=Q.useEffect;Q.useContext,Q.Fragment,Q.RawHTML;const te=function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(W({}),2),n=t[0],r=t[1];ee((function(){r(e.field)}),[e.field]);var o=function(t){var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){Z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);o.value=t,r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")};return wp.element.createElement("div",{className:"switch"},"S"==n.value?wp.element.createElement("input",{type:"checkbox",id:n.id,checked:!0,onClick:function(){return o("H")}}):wp.element.createElement("input",{type:"checkbox",id:n.id,onClick:function(){return o("S")}}),wp.element.createElement("label",{for:n.id,className:"slider"}))};function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ne(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ne(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ne(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ie=wp.element,le=(ie.createElement,ie.render,ie.useState),ce=ie.useEffect;ie.useContext,ie.Fragment,ie.RawHTML;const ue=function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ae(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(le(e.field),2),n=t[0],r=t[1];ce((function(){r(e.field)}),[e.field]);return wp.element.createElement("div",{className:"textarea_field"},wp.element.createElement("textarea",{id:n.id,value:n.value,onChange:function(t){return function(t){var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);o.value=t.target.value,r(o),r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")}(t)},placeholder:n.default},n.value))};function se(e){return function(e){if(Array.isArray(e))return pe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pe(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var me=wp.element,fe=(me.createElement,me.useState,me.useEffect),de=(me.Fragment,me.render,me.useRef),be=wp.data;function ve(e){if(void 0===e)return!0;if("undefined"===e)return!0;if(null==e)return!0;if("number"==typeof e)return!1;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function ye(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))if(n){for(var r=0;r<t.length;r++)if(t[r][n]===e[n])return r}else for(var o=0;o<t.length;o++)if(t[o].id===e.id)return o;return-1}function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){Ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ee(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==we(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==we(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===we(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_e(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}be.dispatch,be.select;var je=wp.element,Se=(je.createElement,je.render,je.useState),ke=je.useEffect,Pe=je.useContext;je.Fragment,je.RawHTML;const Ne=function(e){Pe(CourseContext);var t=Oe(Se(!1),2),n=t[0],r=t[1],o=Oe(Se({}),2),a=o[0],i=o[1];return ke((function(){var t=ge({},e.field);ve(e.field.value)&&!ve(e.field.default)&&(t.value=e.field.default),i(t)}),[e.field]),wp.element.createElement("div",{className:"number"},n||9999!==a.value?wp.element.createElement("input",{type:"number",id:a.id,value:a.value,onChange:function(t){return function(t){var n=ge({},a);n.value=t.target.value,i(n),e.update(n,e.fieldIndex,"fieldvaluechanged")}(t)},placeholder:a.default}):wp.element.createElement("span",{onClick:function(){return r(!n)}},window.vibeprojects.translations.unlimited))};function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ae(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ae(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Te=wp.element,De=(Te.createElement,Te.render,Te.useState),Ue=Te.useEffect;Te.useContext,Te.Fragment,Te.RawHTML;const Me=function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ce(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(De({}),2),n=t[0],r=t[1];Ue((function(){r(e.field)}),[e.field]);return wp.element.createElement("div",{className:"number"},wp.element.createElement("input",{type:"number",id:n.id,value:n.value,onChange:function(t){return function(t){var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){xe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);o.value=t.target.value,r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")}(t)},placeholder:n.default}))};function Je(e){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(e)}function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Je(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Je(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Je(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fe=wp.element,He=(Fe.createElement,Fe.render,Fe.useState),qe=Fe.useEffect;Fe.useContext,Fe.Fragment,Fe.RawHTML;const Be=function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return $e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$e(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(He({}),2),n=t[0],r=t[1];qe((function(){r(e.field)}),[e.field]);return wp.element.createElement("div",{className:"vibe_form_field "+n.id},wp.element.createElement("input",{type:"text",id:n.id,value:n.value,onChange:function(t){return function(t){var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){Re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);o.value=t.target.value,r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")}(t)},placeholder:n.default}))};function ze(e){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ze(e)}function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ye(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ze(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ze(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ze(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ke(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xe(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ze=wp.element,Ge=(Ze.createElement,Ze.render,Ze.useState),Qe=Ze.useEffect,We=(Ze.useContext,Ze.useRef);Ze.Fragment,Ze.RawHTML;const et=function(e){var t=We(null),n=Ke(Ge(e.field),2),r=n[0],o=n[1],a=Ke(Ge("vibe_form_field "+e.field.id),2),i=a[0],l=a[1];Qe((function(){o(e.field)}),[e.field]),Qe((function(){if(r.hasOwnProperty("isEmpty")&&r.isEmpty){l(i+" erroremptyvalue");var n=window.scrollX,o=window.scrollY;window.scrollTo(n,o),t.current.focus()}else{var a="vibe_form_field "+e.field.id;l(a)}}),[r,r.isEmpty,r.random]);return wp.element.createElement("div",{className:i},wp.element.createElement("label",null,r.label," ",wp.element.createElement("span",{className:"tip",title:r.desc},wp.element.createElement("span",{className:"vicon vicon-info-alt"}))),wp.element.createElement("input",{ref:t,type:"text",className:"text_field",onChange:function(t){var n,a;n=t.target.value,a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){Ye(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r),a.value=n,n.length&&(a.isEmpty=!1),o(a),e.update(a,e.fieldIndex,"fieldvaluechanged")},placeholder:r.default,value:r.value,onBlur:function(t){e.update(r,e.fieldIndex,"enabledrafting")}}))};function tt(e){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(e)}function nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==tt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===tt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var at=wp.element,it=(at.createElement,at.render,at.useState),lt=at.useEffect;at.useContext,at.Fragment,at.RawHTML;const ct=function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ot(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(it({}),2),n=t[0],r=t[1];lt((function(){r(e.field)}),[e.field]);return wp.element.createElement("div",{className:"select"},wp.element.createElement("select",{id:n.id,onChange:function(t){return function(t){var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(n),!0).forEach((function(t){rt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);o.value=t.target.value,r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")}(t)}},wp.element.createElement("option",null,window.helpdesk.translations.select_option),n.options&&n.options.length?n.options.map((function(e,t){var r=!1;return e.value==n.value&&(r=!0),wp.element.createElement("option",{value:e.value,selected:r},e.label)})):""))};function ut(e){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ut(e)}function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ut(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ut(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bt=wp.element,vt=(bt.createElement,bt.render,bt.useState),yt=bt.useEffect,wt=(bt.useContext,bt.Fragment,bt.RawHTML,bt.useRef);const ht=function(e){var t=ft(vt(e.field),2),n=t[0],r=t[1],o=ft(vt(null),2),a=o[0],i=o[1],l=wt(null);yt((function(){r(e.field)}),[e.field]),yt((function(){if(i(null),l.current){var t={altInput:!0,dateFormat:"Y-m-d",defaultDate:e.field.hasOwnProperty("value")&&e.field.value.length?e.field.value:[],onChange:c};window.vibebp.settings.flatpickrLang&&(t.locale=window.vibebp.settings.flatpickrLang);var n=flatpickr(l.current,t);i(n)}}),[]);var c=function(t){var o=pt({},n);if(t&&t.length){var a=t[0].getDate();(a=a.toString()).length<2&&(a="0"+a);var i=t[0].getMonth()+1;(i=i.toString()).length<2&&(i="0"+i);var l=t[0].getFullYear()+"-"+i+"-"+a;o.value=l}else o.value="";r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")};return wp.element.createElement("div",{className:"date"},wp.element.createElement("input",{type:"text",ref:l,placeholder:window.vibeprojects.translations.select_date}),n.hasOwnProperty("value")&&n.value&&n.value.length?wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var t=pt({},n);t.value=null,e.update(t,e.fieldIndex,"fieldvaluechanged"),a&&a.clear()}}):wp.element.createElement("span",{className:"vicon vicon-calendar"}))};function gt(e){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gt(e)}function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach((function(t){_t(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _t(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==gt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==gt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===gt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return St(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?St(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var kt=wp.element,Pt=(kt.createElement,kt.render,kt.useState),Nt=kt.useEffect,At=(kt.useContext,kt.Fragment,kt.RawHTML,kt.useRef);const It=function(e){var t=jt(Pt(e.field),2),n=t[0],r=t[1],o=jt(Pt(null),2),a=o[0],i=o[1],l=At(null);Nt((function(){r(e.field)}),[e.field]),Nt((function(){if(i(null),l.current){var t={enableTime:!0,noCalendar:!0,dateFormat:"H:i",defaultDate:e.field.hasOwnProperty("value")&&e.field.value.length?e.field.value:[],onChange:c},n=flatpickr(l.current,t);window.vibebp.settings.flatpickrLang&&(t.locale=window.vibebp.settings.flatpickrLang),i(n)}}),[]);var c=function(t){var o=Ot({},n);if(t&&t.length){var a=t[0].getHours()+":"+t[0].getMinutes();o.value=a}else o.value="";r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")};return wp.element.createElement("div",{className:"date time"},wp.element.createElement("input",{type:"text",ref:l}),n.hasOwnProperty("value")&&n.value&&n.value.length?wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var t=Ot({},n);t.value=null,e.update(t,e.fieldIndex,"fieldvaluechanged"),a&&a.clear()}}):"")};function xt(e){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(e)}function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==xt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==xt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===xt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ut(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Mt=wp.element,Jt=(Mt.createElement,Mt.render,Mt.useState),Lt=Mt.useEffect;Mt.useContext,Mt.Fragment,Mt.RawHTML;const Rt=function(e){var t=Dt(Jt(e.field),2),n=t[0],r=t[1],o=Dt(Jt({post_content:"",raw:{}}),2),a=(o[0],o[1]),i=Dt(Jt(Math.round(1e5*Math.random())),2),l=i[0];i[1],Lt((function(){localforage.setItem("fixedToolbar",1)}),[]),Lt((function(){if(e.field){var t=new CustomEvent("load_vibe_editor",{detail:{id:e.field.post_id?e.field.post_id:"",selector:".vibe_"+e.field.id+l+"_editor",content:e.field.hasOwnProperty("value")?e.field.value:"",raw:e.field.hasOwnProperty("raw")?e.field.raw:"",components:["editor"],updater:e.field.id+l}});document.dispatchEvent(t)}}),[e.field]),Lt((function(){return e.field&&e.field.id&&document.addEventListener("vibe_editor_content_update_"+e.field.id+l,c,!1),function(){e.field&&e.field.id&&document.removeEventListener("vibe_editor_content_update_"+e.field.id+l,c)}}));var c=function(t){a({post_content:t.detail.raw_html,raw:t.detail.editor_content});var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(n),!0).forEach((function(t){Tt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.field);n.value=t.detail.raw_html,n.raw=t.detail.editor_content,JSON.stringify(n.raw)!==JSON.stringify(e.field.raw)&&(r(n),e.update(n,e.fieldIndex,"fieldvaluechanged"))};return wp.element.createElement("div",{className:"vibe_projects_editor"},wp.element.createElement("div",{className:"vibe_"+n.id+l+"_editor"},wp.element.createElement("textarea",{value:n.value})))};var $t=wp.element;$t.createElement,$t.render;const Ft=function(e){return wp.element.createElement("div",{class:"lds-ellipsis"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null))};function Ht(e){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ht(e)}function qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qt(Object(n),!0).forEach((function(t){zt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ht(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ht(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Kt=wp.element,Xt=(Kt.createElement,Kt.render,Kt.useState),Zt=Kt.useEffect,Gt=Kt.useContext,Qt=Kt.Fragment,Wt=(Kt.RawHTML,wp.data),en=Wt.dispatch,tn=Wt.select;const nn=function(e){Gt(CourseContext);var t=Vt(Xt({}),2),n=t[0],r=t[1],o=Vt(Xt(""),2),a=o[0],i=o[1],l=Vt(Xt([]),2),c=l[0],u=l[1],s=Vt(Xt({}),2),p=s[0],m=s[1],f=Vt(Xt(!1),2),d=f[0],b=f[1],v=tn("vibebp").getUser();return v.token=tn("vibebp").getToken(),Zt((function(){e.field&&e.field.hasOwnProperty("show_value")&&m(e.field.show_value),r(e.field)}),[e.field]),Zt((function(){var t=Bt({},n);p.id&&(t.value=p.id,t.show_value=p,r(t),e.update(t,e.fieldIndex,"fieldvaluechanged"))}),[p]),Zt((function(){if(a.length>3){b(!0);var e="",t="";n.cpt&&(e=n.cpt,t="selectcpt"),n.post_type&&(e=n.post_type,t="selectcpt"),n.taxonomy&&(e=n.taxonomy,t="taxonomy"),fetch("".concat(window.vibeprojects.api_url,"/").concat(t,"/").concat(e),{method:"post",body:JSON.stringify({search:a,token:v.token})}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(e){e.status&&Array.isArray(e.posts)&&(e.posts.map((function(e){localStorage.setItem("post_"+e.id,JSON.stringify(e))})),u(e.posts)),b(!1)})).catch((function(e){setIsSaving(!1),console.error("Uh oh, an error!",e),en("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}))}}),[a]),wp.element.createElement("div",{className:"selectcptfield"},wp.element.createElement("div",{className:"selectcptfield_list"},p&&p.text?wp.element.createElement("div",{className:"selectcptfield_items"},wp.element.createElement("span",{type:n.cpt,onClick:function(){m({})}},p.text)):""),p&&p.text?"":wp.element.createElement(Qt,null,wp.element.createElement("div",{className:d?"control is-loading":"control"},wp.element.createElement("input",{type:"text",value:a,placeholder:window.vibeprojects.translations.type_keyword,onChange:function(e){i(e.target.value)}})),c.length?wp.element.createElement("div",{className:"search_results"},c.map((function(e,t){return wp.element.createElement("div",{className:"search_result selectcpt",onClick:function(){i("");var n=Bt({},p);n=e,c.splice(t,1),m(n)}},wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:e.text}}))}))):""))};function rn(e){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rn(e)}function on(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function an(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?on(Object(n),!0).forEach((function(t){ln(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):on(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ln(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==rn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==rn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===rn(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cn(e){return function(e){if(Array.isArray(e))return pn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||sn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function un(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||sn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sn(e,t){if(e){if("string"==typeof e)return pn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pn(e,t):void 0}}function pn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var mn=wp.element,fn=(mn.createElement,mn.render,mn.useState),dn=mn.useEffect,bn=(mn.useContext,mn.Fragment,mn.RawHTML,wp.data),vn=bn.dispatch,yn=bn.select;const wn=function(e){var t=un(fn({}),2),n=t[0],r=t[1],o=un(fn(""),2),a=o[0],i=o[1],l=un(fn([]),2),c=l[0],u=l[1],s=un(fn([]),2),p=s[0],m=s[1],f=un(fn(!1),2),d=f[0],b=f[1],v=un(fn(!1),2),y=v[0],w=v[1];return yn("vibebp").getUser().token=yn("vibebp").getToken(),dn((function(){e.field&&e.field.hasOwnProperty("show_value")&&m(e.field.show_value),r(e.field)}),[e.field]),dn((function(){if(a.length>3){w(!0);var e="",t="";n.cpt&&(e=n.cpt,t="selectcpt"),n.post_type&&(e=n.post_type,t="selectcpt"),n.taxonomy&&(e=n.taxonomy,t="taxonomy"),fetch("".concat(window.vibeprojects.api_url,"/").concat(t,"/").concat(e),{headers:{Authorization:window.vibeprojects.token},method:"post",body:JSON.stringify({search:a,token:yn("vibebp").getToken()})}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(e){e.status?Array.isArray(e.posts)&&(e.posts.map((function(e){localStorage.setItem("post_"+e.id,JSON.stringify(e))})),u(e.posts)):vn("vibebp").addNotification({text:e.message}),w(!1)})).catch((function(e){w(!1),console.error("Uh oh, an error!",e),vn("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}))}}),[a]),wp.element.createElement("div",{className:"selectcptfield"},wp.element.createElement("div",{className:"selectcptfield_list"},p.length?wp.element.createElement("div",{className:"selectcptfield_items"},p.map((function(t){var o=n.cpt?n.taxonomy:"";return wp.element.createElement("span",{type:o,onClick:function(){var o=cn(p);o.splice(ye(t,p),1),m(o);var a=an({},n);if(o&&o.length){var i=[];o.map((function(e){i.push(e.id)})),a.value=i,a.show_value=o,r(a),e.update(a,e.fieldIndex,"fieldvaluechanged")}else a.value=[],a.show_value=[],e.update(a,e.fieldIndex,"fieldvaluechanged")}},t.text)}))):""),d?wp.element.createElement("span",{className:"add_wrapper"},wp.element.createElement("div",{className:y?"control is-loading":"control"},wp.element.createElement("input",{type:"text",value:a,placeholder:n.hasOwnProperty("placeholder")?n.placeholder:window.vibeprojects.translations.type_keyword,onChange:function(e){i(e.target.value)}})),wp.element.createElement("span",{onClick:function(){b(!d)},className:"vicon vicon-close"})):wp.element.createElement("span",{className:"add_wrapper",onClick:function(){b(!d)}},window.vibeprojects.translations.add,wp.element.createElement("span",{className:"vicon vicon-plus"})),c.length?wp.element.createElement("div",{className:"search_results"},c.map((function(t,o){if(-1===ye(t,p))return wp.element.createElement("div",{className:"search_result selectcpt",onClick:function(){i("");var a=cn(p);if(-1===ye(t,a)){a.push(t),c.splice(o,1),m(a);var l=an({},n);if(a&&a.length){var u=[];a.map((function(e){u.push(e.id)})),l.value=u,l.show_value=a,r(l),e.update(l,e.fieldIndex,"fieldvaluechanged")}}}},wp.element.createElement("span",null,t.text))}))):"")};function hn(e){return hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hn(e)}function gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function En(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gn(Object(n),!0).forEach((function(t){On(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function On(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==hn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==hn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===hn(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _n(e){return function(e){if(Array.isArray(e))return kn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Sn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||Sn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sn(e,t){if(e){if("string"==typeof e)return kn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kn(e,t):void 0}}function kn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Pn=wp.element,Nn=(Pn.createElement,Pn.render,Pn.useState),An=Pn.useEffect;Pn.useContext,Pn.Fragment,Pn.RawHTML;const In=function(e){var t=jn(Nn({}),2),n=t[0],r=t[1],o=jn(Nn(""),2),a=(o[0],o[1]),i=jn(Nn([]),2),l=i[0],c=i[1],u=jn(Nn([]),2),s=u[0],p=u[1],m=jn(Nn(!1),2),f=m[0],d=m[1],b=jn(Nn(!1),2),v=b[0],y=b[1],w=jn(Nn(!1),2),h=w[0],g=w[1];An((function(){if(e.field&&e.field.hasOwnProperty("value")&&e.field.value.length){var t=[];e.field.value.map((function(n){e.field.options.map((function(e){e.value!=n&&e.id!=n||t.push(e)}))})),p(t)}r(e.field),g(!0)}),[e.field]),An((function(){h&&(d(!0),c(_n(n.options)),d(!1))}),[h]);var E="search_results";return v&&(E="search_results active"),wp.element.createElement("div",{className:"selectcptfield multiselect"},wp.element.createElement("div",{className:"selectcptfield_list"},s.length?wp.element.createElement("div",{className:"selectcptfield_items"},s.map((function(t){var o=n.cpt?n.multiselect:"";return wp.element.createElement("span",{type:o,onClick:function(){var o=_n(s),a=_n(l);o.splice(ye(t,s,"value"),1),a.push(t),c(a),p(o);var i=En({},n);if(o&&o.length){var u=[];o.map((function(e){e.hasOwnProperty("id")?u.push(e.id):e.hasOwnProperty("value")&&u.push(e.value)})),i.value=u,i.show_value=o,r(i),e.update(i,e.fieldIndex,"fieldvaluechanged")}else i.value=[],i.show_value=[],r(i),e.update(i,e.fieldIndex,"fieldvaluechanged")}},t.label)}))):""),wp.element.createElement("div",{className:"selectimitate",onClick:function(){y(!v)}},v?wp.element.createElement("i",{class:"vicon vicon-angle-up","aria-hidden":"true"}):wp.element.createElement("i",{class:"vicon vicon-angle-down","aria-hidden":"true"}),l.length?wp.element.createElement("div",{className:E},l.map((function(t,o){if(-1===ye(t,s,"value"))return wp.element.createElement("div",{className:"search_result selectcpt",onClick:function(){a("");var i=_n(s);if(-1===ye(t,i,"value")){i.push(t),l.splice(o,1),p(i);var c=En({},n);if(i&&i.length){var u=[];i.map((function(e){e.hasOwnProperty("id")?u.push(e.id):e.hasOwnProperty("value")&&u.push(e.value)})),c.value=u,c.show_value=i,r(c),e.update(c,e.fieldIndex,"fieldvaluechanged")}}}},wp.element.createElement("span",null,t.label))}))):f?wp.element.createElement("div",{className:"search_results"},wp.element.createElement(Ft,null)):""))};function xn(e){return function(e){if(Array.isArray(e))return Jn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Mn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cn(e){return Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cn(e)}function Tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Cn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Cn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Cn(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Un(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||Mn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mn(e,t){if(e){if("string"==typeof e)return Jn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jn(e,t):void 0}}function Jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ln=wp.element,Rn=(Ln.createElement,Ln.render,Ln.useState),$n=Ln.useEffect,Fn=(Ln.useContext,Ln.Fragment),Hn=(Ln.RawHTML,wp.data),qn=(Hn.dispatch,Hn.select);const Bn=function(e){var t=Un(Rn({}),2),n=t[0],r=t[1],o=Un(Rn(""),2),a=o[0],i=o[1],l=Un(Rn([]),2),c=l[0],u=l[1],s=Un(Rn([]),2),p=s[0],m=s[1],f=Un(Rn(!0),2),d=f[0],b=f[1],v=Un(Rn(!1),2),y=v[0],w=v[1],h=Un(Rn(!1),2),g=h[0],E=h[1],O=qn("vibebp").getUser();O.token=qn("vibebp").getToken(),$n((function(){r(e.field),E(!0)}),[e.field]),$n((function(){if(g&&!d){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tn(Object(n),!0).forEach((function(t){Dn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n),o=[];p&&p.length?(p.map((function(e){o.push(e.id)})),t.value=o,r(t),e.update(t,e.fieldIndex,"fieldvaluechanged")):(t.value=o,r(t),e.update(t,e.fieldIndex,"fieldvaluechanged"))}}),[p]),$n((function(){b(!0),setTimeout((function(){n.hasOwnProperty("taxonomy")&&n.taxonomy.length&&(n.taxonomy&&n.taxonomy,fetch("".concat(window.vibeprojects.apiUrl,"/taxonomy/?post"),{method:"post",body:JSON.stringify({taxonomy:n.taxonomy,token:O.token})}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(t){if(t.status&&Array.isArray(t.terms)){if(e.field.hasOwnProperty("value")&&t.terms.length){var n=t.terms.filter((function(t){return e.field.value.indexOf(t.id)>-1}));e.field.value.map((function(e){"string"==typeof e&&e.includes("new_")&&n.push({id:e})})),m(n)}u(t.terms)}b(!1)})))}),200)}),[g]);var _=xn(c);return a.length&&(_=c.filter((function(e){return e.text.toLowerCase().indexOf(a.toLowerCase())>-1}))),wp.element.createElement("div",{className:"taxonomy_field"},p.length?wp.element.createElement("div",{className:"selected_term_list_wrapper"},wp.element.createElement("div",{className:"selected_term_list"},p.map((function(e,t){var r=n.cpt?n.taxonomy:"";return"number"==typeof e.id?wp.element.createElement("div",{className:"term_select"},wp.element.createElement("span",{type:r,onClick:function(){var n=xn(p),r=xn(c);n.splice(t,1),r.push(e),u(r),m(n)}},e.text)):wp.element.createElement("div",{className:"term_select"},wp.element.createElement("input",{type:"text",value:p[t].id.split("new_")[1],placeholder:window.vibeprojects.translations.type_here,onChange:function(e){var n=xn(p);n[t]={id:"new_"+e.target.value},m(n)}}),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var e=xn(p);t>-1&&e.splice(t,1),m(e)}}))})))):"",wp.element.createElement("div",{className:"term_select"},wp.element.createElement("div",{class:"term_select_label",onClick:function(){w(!y)}},n.label,y?wp.element.createElement("i",{class:"vicon vicon-angle-down","aria-hidden":"true"}):wp.element.createElement("i",{class:"vicon vicon-plus","aria-hidden":"true"})),y?wp.element.createElement("div",{className:"search_term_list"},wp.element.createElement("div",{className:"search_term",onClick:function(){var e=xn(p);e.push({id:"new_"}),m(e),w(!1)}},function(){if("object"!=Cn(O.caps)||Array.isArray(O.caps)){if(O.caps.indexOf("edit_posts")>-1)return wp.element.createElement("span",null,window.vibeprojects.translations.add_new)}else if(Object.keys(O.caps).indexOf("edit_posts")>-1)return wp.element.createElement("span",null,window.vibeprojects.translations.add_new)}()),c.length>8?wp.element.createElement("div",{className:"searchbox"},wp.element.createElement("input",{type:"text",value:a,onChange:function(e){return i(e.target.value)}}),wp.element.createElement("span",{className:"vicon vicon-search"})):"",_.length?wp.element.createElement(Fn,null,_.map((function(e,t){if(-1===ye(e,p))return wp.element.createElement("div",{className:"search_term",onClick:function(){i("");var n=xn(p);-1===ye(e,n)&&(n.push(e),c.splice(t,1),m(n),w(!1))}},wp.element.createElement("span",null,e.text))}))):""):""))};function zn(e){return zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zn(e)}function Vn(e){return function(e){if(Array.isArray(e))return Qn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Gn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yn(Object(n),!0).forEach((function(t){Xn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==zn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==zn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===zn(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||Gn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gn(e,t){if(e){if("string"==typeof e)return Qn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qn(e,t):void 0}}function Qn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wn=wp.element,er=(Wn.createElement,Wn.render,Wn.useState),tr=Wn.useEffect,nr=Wn.Fragment,rr=(Wn.useContext,wp.data),or=rr.dispatch,ar=rr.select;const ir=function(e){var t=Zn(er(!1),2),n=t[0],r=t[1],o=Zn(er([]),2),a=o[0],i=o[1],l=Zn(er([]),2),c=l[0],u=(l[1],Zn(er(!1),2)),s=u[0],p=u[1],m=Zn(er(!1),2),f=m[0],d=m[1],b=Zn(er(0),2),v=b[0],y=b[1],w=Zn(er([]),2),h=w[0],g=w[1],E=Zn(er("media"),2),O=E[0],_=E[1],j=Zn(er({posts_per_page:20,paged:1,search_terms:"",orderby:""}),2),S=j[0],k=j[1],P=Zn(er({name:"",url:"",type:"file"}),2),N=P[0],A=P[1];!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=de(Date.now());fe((function(){var n=setTimeout((function(){Date.now()-r.current>=t&&(e(),r.current=Date.now())}),t-(Date.now()-r.current));return function(){clearTimeout(n)}}),[t].concat(se(n)))}((function(){fetch("".concat(window.vibebp.api.url,"/user/fetch_media"),{method:"post",body:JSON.stringify(Kn(Kn({},S),{},{token:ar("vibebp").getToken()}))}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(e){if(r(!1),e.status)if(f){var t=Vn(a);e.data.map((function(e){t.push(e)})),i(t),d(!1),t.length<parseInt(data.total)?p(!0):p(!1)}else i(e.data),e.data.length<parseInt(e.total)?p(!0):p(!1)})).catch((function(e){r(!1),console.error("Uh oh, an error!",e),or("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}))}),500,[S]);var I=function(t){e.share(t)};tr((function(){or("vibebp").setData("mediaTab",O),-1==h.indexOf(O)&&(document.dispatchEvent(new CustomEvent("vibebp_media_tab",{detail:{tab:O}})),document.addEventListener("vibebp_media_tab_submit",(function(t){e.share(t.detail.media),e.close(!1)}),!1),g([].concat(Vn(h),[O])))}),[O]);var x,C=function(e){switch(e.type){case"image":return wp.element.createElement("img",{src:e.url,className:"content_to_html_image"});case"video":return wp.element.createElement("video",{class:"video_plyr"},wp.element.createElement("source",{src:e.url,type:"video/mp4"}));case"audio":return wp.element.createElement("audio",{class:"audio_plyr",controls:!0},wp.element.createElement("source",{src:e.url,type:"audio/mp3"}));default:if(void 0!==e.url&&e.type)return e.url.split(".pdf").length>1?wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("embed",{width:"200px",height:"300px",controls:!0,type:"application/pdf",src:e.url}),wp.element.createElement("div",{className:"embed_block"})):wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("a",{href:e.url},wp.element.createElement("span",{className:"vicon vicon-clip"})))}};return wp.element.createElement("div",{className:"vibe_editor_modal"},wp.element.createElement("span",{onClick:e.close}),wp.element.createElement("div",{className:"ve_modal-content"},wp.element.createElement("div",{className:"ve_modal-header"},wp.element.createElement("div",null,window.vibebp.settings.media_tabs?Object.keys(window.vibebp.settings.media_tabs).map((function(t){if("upload"!=t||!window.vibebp.settings.hasOwnProperty("upload_capability")||!window.vibebp.settings.upload_capability)return wp.element.createElement("a",{className:O==t?"active":"",onClick:function(){_(t)}},window.vibebp.settings.media_tabs[t]);var n=ar("vibebp").getUser();if(void 0!==n&&n.hasOwnProperty("caps")&&void 0!==n.caps){var r=0;if(Array.isArray(n.caps)?n.caps.findIndex((function(e,t){return e==window.vibebp.settings.upload_capability}))>-1&&(r=1):"object"===zn(n.caps)&&Object.keys(n.caps).map((function(e,t){e===window.vibebp.settings.upload_capability&&n.caps[e]&&(r=1)})),e.hasOwnProperty("allow_upload")&&e.allow_upload&&(r=1),r)return wp.element.createElement("a",{className:O==t?"active":"",onClick:function(){_(t)}},window.vibebp.settings.media_tabs[t])}})):""),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(t){e.close(!1)}})),wp.element.createElement("div",{className:"ve_modal-body"},"media"===O?wp.element.createElement(nr,null,wp.element.createElement("div",{className:"vibebp_form"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("input",{type:"text",placeholder:window.vibebp.translations.search_text,onChange:function(e){return k(Kn(Kn({},S),{},{search_terms:e.target.value}))}})),wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("select",{onChange:function(e){k(Kn(Kn({},S),{},{order:e.target.value}))}},Object.keys(window.vibeEditor.media_order).map((function(e){return wp.element.createElement("option",{value:e},window.vibeEditor.media_order[e])}))))),n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):a&&a.length?wp.element.createElement("div",{className:"allMedia"},a.map((function(t,n){return wp.element.createElement("div",{className:"single_media"},wp.element.createElement("span",{onClick:function(n){I(t),e.close(!1)}},C(t)),wp.element.createElement("span",{className:"filename",onClick:function(n){I(t),e.close(!1)}},t.name),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){return function(e){var t=Vn(a);t.splice(t.findIndex((function(t){return t.id==e.id})),1),i(t),fetch("".concat(window.vibebp.api.url,"/user/delete_media"),{method:"post",body:JSON.stringify({token:ar("vibebp").getToken(),media:e})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&or("vibebp").addNotification({text:e.message})}))}(t)}}))}))):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_media),s?wp.element.createElement("a",{className:"link",onClick:function(){k(Kn(Kn({},S),{},{paged:S.paged+1})),d(!0)}},window.vibebp.translations.more):""):"upload"===O?wp.element.createElement(nr,null,wp.element.createElement("div",{className:"upload_media"},wp.element.createElement("label",{for:"vibe_editor_upload_media"},v?wp.element.createElement("div",{className:"vibebp_progress_wrapper"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{className:"progress_bar",style:{width:v+"%"}})),wp.element.createElement("span",null,v,"%")):wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("input",{type:"file",id:"vibe_editor_upload_media",onChange:function(e){return function(e){if(e.target.files[0]){var t=e.target.files[0].size/1024/1024;if(tus.isSupported&&tus.canStoreURLs&&t>4){var n="".concat(window.vibebp.api.url,"/user/upload_media_stream"),r=new tus.Upload(e.target.files[0],{endpoint:n,chunkSize:2097152,retryDelays:[0,3e3],metadata:{token:ar("vibebp").getToken(),filename:e.target.files[0].name,filetype:e.target.files[0].type},onError:function(e){e.hasOwnProperty("message")&&or("vibebp").addNotification({text:e.message})},onProgress:function(e,t){var n=(e/t*100).toFixed(2);y(n),100==n&&setTimeout((function(){k({posts_per_page:20,paged:1,search_terms:"",orderby:""}),y(0),_("media")}),500)},onSuccess:function(){localStorage.removeItem(r._urlStorageKey),fetch("".concat(r.url,"/complete_stream"),{method:"post",body:JSON.stringify({token:ar("vibebp").getToken()})}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(e){e.status&&(k({posts_per_page:20,paged:1,search_terms:"",orderby:""}),y(0),_("media")),e.hasOwnProperty("message")&&or("vibebp").addNotification({text:e.message})})).catch((function(e){console.error("Uh oh, an error!",e),or("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}))}});r.findPreviousUploads().then((function(e){e.length>0&&r.resumeFromPreviousUpload(e[0]),r.start()})),tus.Upload.terminate(n).then((function(){})).catch((function(e){}))}else{var o=new FormData;o.append("file",e.target.files[0]),o.append("body",JSON.stringify({token:ar("vibebp").getToken()})),fetch("".concat(window.vibebp.api.url,"/user/upload_media"),{method:"post",body:o}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(e){if(e.status){var t=Vn(a);t.unshift(e.data),i(t),_("media")}else e.hasOwnPropoerty("message")&&or("vibebp").addNotification({text:e.message})})).catch((function(e){console.error("Uh oh, an error!",e),or("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}))}}}(e)}}),c&&c.length?wp.element.createElement("div",{className:"uploaded"},wp.element.createElement("strong",null,window.vibebp.translations.uploaded_media),wp.element.createElement("div",{className:"uploaded_files"},c.map((function(e,t){return wp.element.createElement("div",{className:"single_media",onClick:function(t){I(e)}},C(e))})))):"")):"embed"===O?wp.element.createElement(nr,null,wp.element.createElement("div",{className:"embed_media"},wp.element.createElement("label",{for:"vibe_editor_embed_name"}," ",window.vibebp.translations.enter_emabed_name," "),wp.element.createElement("input",{type:"text",id:"vibe_editor_embed_name",onChange:function(e){return A(Kn(Kn({},N),{},{name:e.target.value}))}}),wp.element.createElement("label",{for:"vibe_editor_embed_url"}," ",window.vibebp.translations.enter_embed_url," "),wp.element.createElement("input",{type:"text",id:"vibe_editor_embed_url",onChange:function(e){return A(Kn(Kn({},N),{},{url:e.target.value}))}}),wp.element.createElement("select",{onChange:function(e){return A(Kn(Kn({},N),{},{type:e.target.value}))},value:N.type},Object.keys(window.vibeEditor.embed_types).map((function(e){return wp.element.createElement("option",{value:e},window.vibeEditor.embed_types[e])}))),Object.values(N).findIndex((function(e){return""==e||null==e}))>-1?"":wp.element.createElement("button",{className:"button is-primary",onClick:function(){I(N),e.close(!1)}},window.vibebp.translations.embed))):wp.element.createElement("div",null,(x=new CustomEvent("vibebp_media_tab",{detail:{tab:O}}),document.dispatchEvent(x),wp.element.createElement("div",{className:O}))))))};function lr(e){return lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lr(e)}function cr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ur(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cr(Object(n),!0).forEach((function(t){sr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==lr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==lr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===lr(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return mr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var fr=wp.element,dr=(fr.createElement,fr.render),br=fr.useState,vr=fr.useEffect,yr=(fr.Fragment,fr.useContext,fr.useRef,wp.data);yr.dispatch,yr.select;const wr=function(e){var t=pr(br(!1),2),n=t[0],r=t[1],o=pr(br({}),2),a=o[0],i=o[1],l=pr(br(!1),2),c=l[0],u=l[1],s=pr(br(!1),2),p=s[0],m=s[1],f=pr(br(!1),2),d=f[0],b=f[1],v=pr(br([]),2),y=(v[0],v[1],pr(br(null),2)),w=y[0],h=y[1],g=pr(br(null),2),E=g[0],O=g[1];vr((function(){e.hasOwnProperty("media")&&(e.field.value=e.media),e.field.hasOwnProperty("type")&&i(e.field)}),[e.field]),vr((function(){if(a.hasOwnProperty("value")&&a.value&&a.value.hasOwnProperty("type")&&w){if("audio"==a.value.type||"video"==a.value.type){var e=new Plyr(w);O(e)}if("youtube"==a.value.type){var t=new Plyr(w);O(t)}if("vimeo"==a.value.type){var n=new Plyr(w);O(n)}if("dash"==a.value.type){dashjs.MediaPlayer().create().initialize(w,a.value.url,!0);var r=new Plyr(w,{captions:{active:!0,update:!0}});O(r)}if("hls"==a.value.type){var o=new Plyr(w,{captions:{active:!0,update:!0}});if(Hls.isSupported()){var i=new Hls;i.loadSource(a.value.url),i.attachMedia(w)}else w.src=a.value.url;O(o)}}}),[w,a]);var _=function(e){e&&h(e)};return wp.element.createElement("div",{className:"media_wrapper"},a&&a.hasOwnProperty("value")&&a.value&&a.value.hasOwnProperty("url")?wp.element.createElement("div",{className:"media_file"},wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var t=ur({},a);u(!1),m(!1),E&&(E.destroy(),O(null)),t.value=null,i(t),e.update(t,e.fieldIndex,"fieldvaluechanged")}}),wp.element.createElement("div",null," ",function(){if(a.hasOwnProperty("value")&&a.value&&a.value.hasOwnProperty("type")&&a.value.hasOwnProperty("url"))switch(a.value.type){case"image":return wp.element.createElement("img",{src:a.value.url,className:"content_to_html_image"});case"video":return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("video",{className:"content_to_html_video",ref:function(e){e&&h(e)}},wp.element.createElement("source",{src:a.value.url,type:"video/mp4"})));case"audio":return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("audio",{className:"content_to_html_audio",ref:function(e){e&&h(e)}},wp.element.createElement("source",{src:a.value.url,type:"audio/mp3"}))," ");case"youtube":var e=!(!(n=a.value.url.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&|?]+)/))||!n.length)&&n[1];return e?wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("div",{ref:function(e){e&&h(e)},"data-plyr-provider":"youtube","data-plyr-embed-id":e})):wp.element.createElement("div",{className:"video_wrapper"}," ",wp.element.createElement("span",{className:"vicon vicon-alert"},window.wplms_course_data.translations.invalid_url));case"vimeo":var t=a.value.url.match(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/);return wp.element.createElement("div",{className:"video_wrapper"}," ",wp.element.createElement("div",{ref:function(e){e&&h(e)},"data-plyr-provider":"vimeo","data-plyr-embed-id":t[4]}));case"hls":if("m3u8"==a.value.url.split(".").pop())return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("video",{ref:_,controls:!0,crossorigin:!0,playsinline:!0}));break;case"dash":if("mpd"==a.value.url.split(".").pop())return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("video",{ref:_,controls:!0,crossorigin:!0,playsinline:!0}));break;default:if(void 0!==a.value.url&&a.value.hasOwnProperty("type"))return a.value.url.split(".pdf").length>1?wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("embed",{width:"200px",height:"300px",controls:!0,type:"application/pdf",src:a.value.url.url}),wp.element.createElement("div",{className:"embed_block"})):wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("a",{href:a.value.url.url},wp.element.createElement("span",{className:"vicon vicon-clip"}),wp.element.createElement("span",null,a.value.name)))}var n}()," ")):"course_featured"==a.type?wp.element.createElement("div",{onClick:function(){r(!0)}},wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-image"},wp.element.createElement("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),wp.element.createElement("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),wp.element.createElement("polyline",{points:"21 15 16 10 5 21"}))):"featured_video"==a.type?wp.element.createElement("div",{className:"featured_video"},wp.element.createElement("span",{onClick:function(){u(!1)}},a.label),c&&!p?wp.element.createElement("input",{type:"text",placeholder:window.vibeprojects.translations.enter_video_link+" ("+c+")",value:a.value?a.value.url:"",className:p?"is-success":"is-danger",onChange:function(t){if(b(!1),"youtube"==c)if(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&|?]+)/.test(t.target.value)){m(!0);var n=ur({},a);n.value={type:"youtube",url:t.target.value},i(n),e.update(n,e.fieldIndex,"fieldvaluechanged")}else m(!1);if("vimeo"==c)if(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/.test(t.target.value)){m(!0);var r=ur({},a);r.value={type:"vimeo",url:t.target.value},i(r),e.update(r,e.fieldIndex,"fieldvaluechanged")}else m(!1);if("hls"==c)if("m3u8"==t.target.value.split(".").pop()){m(!0);var o=ur({},a);o.value={type:"hls",url:t.target.value},i(o),e.update(o,e.fieldIndex,"fieldvaluechanged")}else m(!1);if("dash"==c)if("mpd"==t.target.value.split(".").pop()){m(!0);var l=ur({},a);l.value={type:"dash",url:t.target.value},i(l),e.update(l,e.fieldIndex,"fieldvaluechanged")}else m(!1)}}):wp.element.createElement("div",{className:"featured_video_options"},wp.element.createElement("span",{className:"vicon vicon-control-play",onClick:function(){b(!1),r(!0)}}),wp.element.createElement("span",{className:"vicon vicon-youtube",onClick:function(){return u("youtube")}}),wp.element.createElement("span",{className:"vicon vicon-vimeo-alt",onClick:function(){return u("vimeo")}}),window.vibeprojects.settings.advanced_video_format_hls?wp.element.createElement("span",{className:"vicon vicon-video-clapper",onClick:function(){return u("hls")}}):"",window.vibeprojects.settings.advanced_video_format_dash?wp.element.createElement("span",{className:"vicon vicon-video-clapper",onClick:function(){return u("dash")}}):"",window.vibeprojects.settings.advanced_video_format_360?wp.element.createElement("span",{className:"vicon vicon-loop",onClick:function(){b("360"),r(!0)}}):"")):"featured_audio"==a.type?wp.element.createElement("div",{className:"featured_video",onClick:function(){r(!0)}},a.label,wp.element.createElement("span",{className:"vicon vicon-control-play"})):wp.element.createElement("div",{className:"vicon vicon-plus",onClick:function(){r(!0)}}),n?wp.element.createElement("div",null,function(){document.querySelector("#vibemediamodal")&&document.querySelector("#vibemediamodal").remove();var t=document.createElement("div");t.setAttribute("id","vibemediamodal"),document.body.appendChild(t),dr(wp.element.createElement(ir,{type:e.type,close:function(){r(!1),document.querySelector("#vibemediamodal").remove()},share:function(t){!function(t){var n=ur({},a);d&&(t.videotype=d),n.value=t,i(n),e.update(n,e.fieldIndex,"fieldvaluechanged")}(t)}}),document.getElementById("vibemediamodal"))}()):"")};function hr(e){return hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hr(e)}function gr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Er(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gr(Object(n),!0).forEach((function(t){Or(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Or(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==hr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==hr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===hr(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var jr=wp.element,Sr=(jr.createElement,jr.render,jr.useState),kr=jr.useEffect,Pr=(jr.Fragment,jr.useContext,wp.data);Pr.dispatch,Pr.select;const Nr=function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Sr({}),2),n=t[0],r=t[1];kr((function(){r(e.field)}),[e.field]);var o=function(t,o,a){if("fieldvaluechanged"==a){var i=Er({},n);t.value&&t.value.hasOwnProperty("url")?i.value[o]=t.value:i.value.splice(o,1),r(i),e.update(i,e.fieldIndex,"fieldvaluechanged")}};return wp.element.createElement("div",{className:"multimedia"},wp.element.createElement("span",{className:"vicon vicon-plus button",onClick:function(){var e=Er({},n);e.hasOwnProperty("value")&&Array.isArray(e.value)||(e.value=[]),e.value.push({}),r(e)}}),n.value&&n.value.length?wp.element.createElement("div",{className:"attachments"},n.value.map((function(e,t){return wp.element.createElement("div",{className:"attachment"},wp.element.createElement(wr,{field:{type:n.id},media:e,fieldIndex:t,update:o}))}))):"")};function Ar(e){return Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ar(e)}function Ir(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ir(Object(n),!0).forEach((function(t){Cr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ir(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Cr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ar(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ar(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ar(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Dr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ur=wp.element,Mr=(Ur.createElement,Ur.render,Ur.useState),Jr=Ur.useEffect;Ur.useContext,Ur.Fragment,Ur.RawHTML;const Lr=function(e){var t=Tr(Mr(!1),2),n=t[0],r=t[1],o=Tr(Mr({}),2),a=o[0],i=o[1];Jr((function(){var t=xr({},e.field);ve(t.value)&&(t.value=xr({},t.default),e.update(t,e.fieldIndex,"fieldvaluechanged")),i(t)}),[e.field]);var l=function(t){var n=xr({},a);n.value=t,i(n),e.update(n,e.fieldIndex,"fieldvaluechanged")};return wp.element.createElement("div",{className:"duration_field_wrapper"},n?wp.element.createElement("div",{className:"duration_field"},wp.element.createElement("input",{type:"text",value:a.value&&a.value.hasOwnProperty("value")?a.value.value:"",onChange:function(e){return l(xr(xr({},a.value),{},{value:e.target.value}))}}),wp.element.createElement("select",{value:a.value&&a.value.hasOwnProperty("parameter")?a.value.parameter:86400,onChange:function(e){l(xr(xr({},a.value),{},{parameter:e.target.value}))}},window.vibeprojects.duration.map((function(e){return wp.element.createElement("option",{value:e.value},e.label)}))),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){a.value.hasOwnProperty("parameter")||l(xr(xr({},a.value),{},{parameter:86400})),r(!n)}})):ve(a.value)?"number"==typeof a.default&&9999==a.default&&"object"==Ar(a.default)&&9999==a.default.value?wp.element.createElement("div",{className:"duration_field"},wp.element.createElement("span",null,window.vibeprojects.translations.unlimited_duration),wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){r(!0),l({value:9999,parameter:86400})}})):wp.element.createElement("div",{className:"duration_field"},wp.element.createElement("span",null,wp.element.createElement("label",null,a.label),"object"==Ar(a.default)?wp.element.createElement("span",null,wp.element.createElement("span",null,a.default.value),wp.element.createElement("span",null,window.vibeprojects.duration[window.vibeprojects.duration.findIndex((function(e){return e.value==a.default.parameter}))].label)):wp.element.createElement("span",null,wp.element.createElement("span",null,a.default),wp.element.createElement("select",{onChange:function(e){l({value:a.default,parameter:e.target.value})}},window.vibeprojects.duration.map((function(e){return wp.element.createElement("option",{value:e.value},e.label)}))))),wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){return r(!0)}})):"object"==Ar(a.value)&&9999==a.value.value?wp.element.createElement("div",{className:"duration_field"},wp.element.createElement("span",null,window.vibeprojects.translations.unlimited_duration),wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){r(!0),l({value:9999,parameter:86400})}})):wp.element.createElement("div",{className:"duration_field"},wp.element.createElement("span",null,"object"==Ar(a.value)?wp.element.createElement("span",null,wp.element.createElement("span",null,a.value.value),wp.element.createElement("span",null,window.vibeprojects.duration[window.vibeprojects.duration.findIndex((function(e){return e.value==a.value.parameter}))].label)):wp.element.createElement("span",null,wp.element.createElement("span",null,a.value),wp.element.createElement("select",{onChange:function(e){l({value:a.default,parameter:e.target.value})}},window.vibeprojects.duration.map((function(e){return wp.element.createElement("option",{value:e.value},e.label)}))))),wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){return r(!0)}})))};function Rr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $r=wp.element,Fr=($r.createElement,$r.render,$r.useState),Hr=$r.useEffect,qr=($r.useContext,$r.Fragment);$r.RawHTML;const Br=function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Rr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Fr({}),2),n=t[0],r=t[1];Hr((function(){r(e.field)}),[e.field]);var o=function(t,n,r){"fieldvaluechanged"==r&&(e.hasOwnProperty("ufieldIndex")?e.update({field:t,index:n,ufieldIndex:e.ufieldIndex},"fieldvaluechanged"):e.update({field:t,index:n},"fieldvaluechanged")),"enabledrafting"==r&&e.update({field:t,cindex:n},"enabledrafting")};return wp.element.createElement(qr,null,void 0!==n?wp.element.createElement("div",{className:"field_wrapper field_"+n.type},"next_button"!=n.type&&"prev_button"!=n.type?wp.element.createElement("span",null,n.label&&"title"!=n.type&&"course_featured"!=n.type&&"next_button"!=n.type&&"prev_button"!=n.type&&"taxonomy"!=n.type&&"featured_video"!=n.type&&"group"!=n.type&&"forum"!=n.type?wp.element.createElement("label",null,n.label,n.hasOwnProperty("desc")?wp.element.createElement("span",{className:"tip",title:n.desc},wp.element.createElement("span",{className:"vicon vicon-info-alt"})):""):"",n.text?wp.element.createElement("strong",null,n.text):""):"",wp.element.createElement("div",{className:"field_value"},function(t,n,r){switch(t.type){case"label":return wp.element.createElement("div",{className:"vibe_form_field "+t.style},wp.element.createElement("strong",{dangerouslySetInnerHTML:{__html:t.default}}));case"title":return wp.element.createElement(et,{field:t,fieldIndex:n,tabIndex:r,update:o});case"taxonomy":return wp.element.createElement(Bn,{field:t,fieldIndex:n,tabIndex:r,update:o});case"course_featured":case"featured_image":case"featured":case"media":return wp.element.createElement(wr,{field:t,type:"image",fieldIndex:n,tabIndex:r,update:o});case"featured_video":return wp.element.createElement(wr,{field:t,type:"video",fieldIndex:n,tabIndex:r,update:o});case"featured_audio":return wp.element.createElement(wr,{field:t,type:"audio",fieldIndex:n,tabIndex:r,update:o});case"textarea":return wp.element.createElement(ue,{field:t,fieldIndex:n,tabIndex:r,update:o});case"editor":return wp.element.createElement(Rt,{field:t,fieldIndex:n,tabIndex:r,update:o});case"unlimited_number":return wp.element.createElement(Ne,{field:t,fieldIndex:n,tabIndex:r,update:o});case"number":return wp.element.createElement(Me,{field:t,fieldIndex:n,tabIndex:r,update:o});case"duration":return wp.element.createElement(Lr,{field:t,fieldIndex:n,tabIndex:r,update:o});case"select":return wp.element.createElement(ct,{field:t,fieldIndex:n,tabIndex:r,update:o});case"selectmulticpt":return wp.element.createElement(wn,{field:t,fieldIndex:n,tabIndex:r,update:o});case"multiselect":return wp.element.createElement(In,{field:t,fieldIndex:n,tabIndex:r,update:o});case"showhide":case"switch":case"yesno":case"conditionalswitch":case"reverseconditionalswitch":return wp.element.createElement(te,{field:t,fieldIndex:n,tabIndex:r,update:o});case"selectcpt":return wp.element.createElement(nn,{field:t,fieldIndex:n,tabIndex:r,update:o});case"text":return wp.element.createElement(Be,{field:t,fieldIndex:n,tabIndex:r,update:o});case"multiattachments":return wp.element.createElement(Nr,{field:t,type:"image",fieldIndex:n,tabIndex:r,update:o});case"time":return wp.element.createElement(It,{field:t,fieldIndex:n,tabIndex:r,update:o});case"date":return wp.element.createElement(ht,{field:t,fieldIndex:n,tabIndex:r,update:o});case"repeatable":case"repeatable_count":return wp.element.createElement(RepeatableOptions,{ufieldIndex:e.ufieldIndex,field:t,fieldIndex:n,cindex:e.cindex,tabIndex:r,update:o});default:var a=new CustomEvent("wplms_custom_field",{detail:{field:t,index:n,props:e,update:o}});if(document.dispatchEvent(a),t&&t.hasOwnProperty("id"))return wp.element.createElement("div",{id:"wplms_custom_field_"+t.id})}return""}(n,e.fieldIndex,e.tabIndex))):"")};function zr(e){return zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zr(e)}function Vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vr(Object(n),!0).forEach((function(t){Kr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==zr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==zr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===zr(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Zr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Gr=wp.element,Qr=(Gr.createElement,Gr.useState),Wr=Gr.useEffect,eo=Gr.useContext,to=(Gr.Fragment,wp.data),no=to.dispatch,ro=to.select;const oo=function(e){var t=Xr(Qr(!1),2),n=(t[0],t[1]),r=Xr(Qr([]),2),o=(r[0],r[1],Xr(Qr([]),2)),a=o[0],i=o[1],l=Xr(Qr({id:e.topic?e.topic.id:e.topic_id?e.topic_id:0,post_title:e.topic?e.topic.post_title:"",post_content:e.topic?e.topic.post_content:"",post_parent:e.forum_id?e.forum_id:0,meta:[]}),2),c=l[0],u=l[1],s=Xr(Qr({raw:{},content:e.topic?e.topic.post_content:""}),2),p=s[0],m=s[1];eo(J),Wr((function(){fetch("".concat(window.helpdesk.api.url,"/bbp/topics/create_fields?post"),{method:"post",body:JSON.stringify({topic_id:c.id,token:ro("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){t.status&&(i(t.fields),t.raw&&m({raw:t.raw,content:e.topic.post_content}))}))}),[]);var f=function(e,t){var n=e.field;if("fieldvaluechanged"==t){if("post"==n.from)if("editor"==n.type)m({post_content:n.value,raw:n.raw});else{var r=Yr({},c);r[n.id]=n.value,u(r)}if("meta"==n.from){var o=Yr({},c),a=o.meta.findIndex((function(e){return e.meta_key==n.id}));a>-1?o.meta[a].meta_value=n.value:o.meta.push({meta_key:n.id,meta_value:n.value}),u(o)}if("taxonomy"==n.from){var i=Yr({},c),l=i.taxonomy.findIndex((function(e){return e.taxonomy==n.id}));l>-1?i.taxonomy[l].value=n.value:i.taxonomy.push({taxonomy:n.id,terms:n.value}),u(i)}}};return wp.element.createElement("div",{className:"vibebp_new_topic"},wp.element.createElement("div",{className:"vibebp_new_topic_header"},wp.element.createElement("span",{className:"vicon vicon-arrow-left",onClick:function(){return e.back()}}),wp.element.createElement("div",{className:"vibebp_topic_actions"},c&&c.hasOwnProperty("post_title")?wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){u(Yr(Yr({},c),{},{post_title:"",post_content:""}))}}):"")),wp.element.createElement("div",{className:"vibebp_form"},wp.element.createElement("div",{className:"vibebp_new_forum"},a.length?a.map((function(t,n){if(!e.forum_id||"post_parent"!=t.id)return wp.element.createElement("div",{className:t.style},wp.element.createElement(Br,{field:t,update:f}))})):wp.element.createElement(Ft,null))),wp.element.createElement("div",{className:"new_forum_buttons"},wp.element.createElement("a",{className:"button is-primary",onClick:function(){n(!0);var t="?post&args=".concat(encodeURIComponent(JSON.stringify(Yr({},c))));fetch("".concat(window.helpdesk.api.url,"/bbp/topics/create").concat(t),{method:"post",body:JSON.stringify(Yr(Yr(Yr({},c),p),{},{token:ro("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(t){n(!1),t.status&&e.back("topics"),t.hasOwnProperty("message")&&no("vibebp").addNotification({text:t.message})}))}},window.helpdesk.translations.create_topic),wp.element.createElement("a",{className:"link",onClick:e.back},window.vibebp.translations.cancel)))};function ao(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return io(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?io(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function io(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lo=wp.element,co=(lo.createElement,lo.useState),uo=lo.useEffect,so=wp.data,po=so.dispatch,mo=so.select;const fo=function(e){var t=ao(co(),2),n=t[0],r=t[1],o=ao(co(!1),2),a=o[0],i=o[1];return uo((function(){e.id&&(i(!0),fetch("".concat(window.helpdesk.api.url,"/bbp/user-info"),{method:"post",body:JSON.stringify({topic_id:e.id,token:mo("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){i(!1),e.status&&e.info&&r(e.info),e.hasOwnProperty("message")&&po("vibebp").addNotification({text:e.message})})).catch((function(e){console.log(e),i(!1)})))}),[]),uo((function(){n&&n.post_content&&document.dispatchEvent(new Event("VibeBP_Editor_Content"))}),[n]),wp.element.createElement("div",{className:"user_info_wrapper"},wp.element.createElement("div",{className:"new_vhd_sidebar_wrapper"},wp.element.createElement("h3",{className:"info_title"},window.helpdesk.translations.user_info),a?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",n?wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:n.post_content}}):wp.element.createElement("div",{className:"vbp_message"},window.helpdesk.translations.no_info)))};function bo(e){return bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bo(e)}function vo(e){return function(e){if(Array.isArray(e))return Oo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Eo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yo(Object(n),!0).forEach((function(t){ho(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ho(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==bo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==bo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===bo(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function go(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||Eo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Eo(e,t){if(e){if("string"==typeof e)return Oo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Oo(e,t):void 0}}function Oo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _o=wp.element,jo=(_o.createElement,_o.useState),So=_o.useEffect,ko=wp.data,Po=ko.dispatch,No=ko.select;const Ao=function(e){var t=go(jo({id:e.id,post_content:""}),2),n=t[0],r=t[1],o=go(jo({saving:!1,getting:!1}),2),a=o[0],i=o[1],l=go(jo([]),2),c=l[0],u=l[1];return So((function(){e.id&&(i(wo(wo({},a),{},{getting:!0})),fetch("".concat(window.helpdesk.api.url,"/bbp/topics/notes"),{method:"post",body:JSON.stringify({id:e.id,token:No("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){i(wo(wo({},a),{},{getting:!1})),e.status&&u(e.data),e.hasOwnProperty("message")&&Po("vibebp").addNotification({text:e.message})})).catch((function(e){console.log(e),i(wo(wo({},a),{},{getting:!1}))})))}),[]),wp.element.createElement("div",{className:"topic_notes_wrapper vibebp_form"},wp.element.createElement("div",{className:"new_vhd_sidebar_wrapper"},wp.element.createElement("h3",{className:"info_title"},window.helpdesk.translations.notes),wp.element.createElement("div",null,wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("textarea",{value:n.post_content,placeholder:window.helpdesk.translations.add_topic_info,onChange:function(e){return r(wo(wo({},n),{},{post_content:e.target.value}))}})),wp.element.createElement("div",{className:"form_action"},n.post_content?wp.element.createElement("a",{className:a.saving?"is-loading button is-primary vicon vicon-save":"button is-primary vicon vicon-save",onClick:function(){n.post_content&&(i(wo(wo({},a),{},{saving:!0})),fetch("".concat(window.helpdesk.api.url,"/bbp/topics/notes/create"),{method:"post",body:JSON.stringify(wo(wo({},n),{},{token:No("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){i(wo(wo({},a),{},{saving:!1})),e.status&&u([e.data].concat(vo(c))),e.hasOwnProperty("message")&&Po("vibebp").addNotification({text:e.message})})).catch((function(e){console.log(e),i(wo(wo({},a),{},{saving:!1}))})))}}):"")),a.getting?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",wp.element.createElement("div",{className:"vhd_notes_wrapper"},c&&c.length?c.map((function(e,t){return wp.element.createElement("div",{key:e.meta_id},wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:e.meta_value}}),wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){return function(e){var t=c[e].meta_id,n=vo(c),r=vo(c);r.splice(e,1),u(r),fetch("".concat(window.helpdesk.api.url,"/bbp/topics/notes/delete"),{method:"post",body:JSON.stringify({meta_id:t,token:No("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status||u(n),e.hasOwnProperty("message")&&Po("vibebp").addNotification({text:e.message})})).catch((function(e){console.log(e)}))}(t)}}))})):wp.element.createElement("div",{className:"vbp_message"},window.helpdesk.translations.no_notes))))};function Io(e){return function(e){if(Array.isArray(e))return Jo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Mo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xo(e){return xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xo(e)}function Co(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function To(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Co(Object(n),!0).forEach((function(t){Do(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Co(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Do(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==xo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==xo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===xo(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Uo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||Mo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mo(e,t){if(e){if("string"==typeof e)return Jo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jo(e,t):void 0}}function Jo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Lo=wp.element,Ro=(Lo.createElement,Lo.useState),$o=Lo.useEffect,Fo=Lo.Fragment,Ho=Lo.useContext,qo=wp.data,Bo=qo.dispatch,zo=qo.select;const Vo=function(e){var t=Uo(Ro(e.topic),2),n=t[0],r=t[1],o=Uo(Ro(!1),2),a=o[0],i=o[1],l=Uo(Ro([]),2),c=l[0],s=l[1],p=Uo(Ro(!0),2),m=p[0],f=p[1],d=Uo(Ro({id:0,post_content:"",raw:"",topic_id:e.topic.id,forum_id:e.topic.forum_id,meta:[]}),2),b=d[0],v=(d[1],Uo(Ro(!1),2)),y=v[0],w=v[1],h=Uo(Ro({paged:1,post_parent:0,order:"DESC",s:""}),2),g=h[0],E=h[1],O=zo("vibebp").getUser(),_=Uo(Ro(null),2),j=_[0],S=_[1],k=Uo(Ro({user:!1,topic:!1}),2),P=k[0],N=k[1],A=Uo(Ro(!1),2),I=(A[0],A[1]),x=Ho(J);$o((function(){return x.update("path",To(To({},x.path),{},{topic:e.topic.id})),function(){var e=To({},x.path);delete e.topic,x.update("path",e)}}),[]),$o((function(){if("object"===xo(e.topic))console.log("object"),r(e.topic),E(To(To({},g),{},{post_parent:e.topic.id})),f(!1);else{E(To(To({},g),{},{post_parent:e.topic}));var t="?args=".concat(encodeURIComponent(JSON.stringify({topic_id:e.topic.id})));fetch("".concat(window.helpdesk.api.url,"/bbp/topic").concat(t),{method:"post",body:JSON.stringify({topic_id:e.topic,token:zo("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){t.status&&(f(!1),r(t.topic),E(To(To({},g),{},{post_parent:e.topic.id})))}))}}),[]),$o((function(){if(g.post_parent){j&&j.abort();var e=new AbortController,t=j?{signal:e.signal}:{};S(e),f(!0);var n=g.s.length?"?nocache":"?args=".concat(encodeURIComponent(JSON.stringify(To(To({},g),{},{s:""})))),r=1!=g.paged||g.s?Io(c):[];s(r),fetch("".concat(window.helpdesk.api.url,"/bbp/replies").concat(n),To(To({method:"post"},t),{},{body:JSON.stringify(To(To({},g),{},{token:zo("vibebp").getToken()}))})).then((function(e){return e.json()})).then((function(e){if(f(!1),e.status){r=1==g.paged?[]:Io(c);var t=[].concat(Io(r),Io(e.replies));w(t.length<parseInt(e.total)),s(t)}e.hasOwnProperty("message")&&Bo("vibebp").addNotification({text:e.message})})).catch((function(e){f(!1),"AbortError"===e.name||(S(null),console.error("Uh oh, an error!",e))}))}}),[g]);var C=function(){E(To(To({},g),{},{s:""}))};return $o((function(){return document.addEventListener("vibebp_component_reload",C),function(){document.removeEventListener("vibebp_component_reload",C)}})),$o((function(){document.dispatchEvent(new Event("VibeBP_Editor_Content"))}),[c]),wp.element.createElement("div",{className:"vibebp_full_topic"},a?wp.element.createElement(oo,{back:function(){i(!1)},topic:n,update:function(t){r(t),e.update(t)}}):wp.element.createElement("div",null,wp.element.createElement("div",{className:"vibebp_full_topic_header"},wp.element.createElement("span",{onClick:e.back},wp.element.createElement("span",{className:"vicon vicon-arrow-left"}),wp.element.createElement("span",null,window.helpdesk.translations.back_to_all_topics)),wp.element.createElement("div",{className:"vibebp_topic_actions"},n.hasOwnProperty("author")&&n.author==O.id?wp.element.createElement(Fo,null,wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){i(n)}}),wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){e.delete(n)}})):"",window.helpdesk.settings.helpdesk&&[window.helpdesk.settings.assigned_tickets.id,window.helpdesk.settings.resolved_tickets.id,window.helpdesk.settings.assign_tickets.id].includes(x.activeTab)?wp.element.createElement("a",{className:"vicon vicon-menu",onClick:function(){N(To(To({},P),{},{topic:!P.topic}))}}):"")),wp.element.createElement("div",{className:"vibebp_main_topic_wrapper"},wp.element.createElement("div",{className:"vibebp_main_topic"},wp.element.createElement("div",{className:"vibe_helpdesk_topic_header"},wp.element.createElement("h1",{dangerouslySetInnerHTML:{__html:n.post_title}}),wp.element.createElement("div",{className:"vibe_helpdesk_topic_header_meta"},wp.element.createElement("div",null,wp.element.createElement(u,{type:"member",id:{user_id:n.author}}),wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:n.last_update}})),wp.element.createElement("div",null,wp.element.createElement("span",{className:n.favorite?"vicon vicon-star active":"vicon vicon-star",onClick:function(){!function(e){var t="?post&args=".concat(encodeURIComponent(JSON.stringify({topic_id:e.id})));e.favorite?fetch("".concat(window.helpdesk.api.url,"/bbp/topics/unfavorite").concat(t),{method:"post",body:JSON.stringify({topic_id:e.id,token:zo("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.status){var n=To({},e);n.favorite=!1,r(n)}t.hasOwnProperty("message")&&Bo("vibebp").addNotification({text:t.message})})):fetch("".concat(window.helpdesk.api.url,"/bbp/topics/favorite").concat(t),{method:"post",body:JSON.stringify({topic_id:e.id,token:zo("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.status){var n=To({},e);n.favorite=!0,r(n)}t.hasOwnProperty("message")&&Bo("vibebp").addNotification({text:t.message})}))}(n)}}),wp.element.createElement("span",{className:n.subscribed?"subscribe active":"subscribe",onClick:function(){!function(e){var t="?post&args=".concat(encodeURIComponent(JSON.stringify({topic_id:topics.id})));fetch("".concat(window.helpdesk.api.url,"/bbp/topics/subscribe").concat(t),{method:"post",body:JSON.stringify({topic_id:e.id,subscribe:!e.subscribed,token:zo("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.status){var n=To({},e);n.subscribed=!n.subscribed,r(n)}else t.hasOwnProperty("message")&&Bo("vibebp").addNotification({text:t.message})}))}(n)}},n.subscribed?window.helpdesk.translations.subscribed:window.helpdesk.translations.subscribe),n.is_resolved?wp.element.createElement("span",{className:"subscribe active"},window.helpdesk.translations.resolved):"","assigned"===e.type||"resolved"===e.type||e.can_assign?wp.element.createElement("span",{className:n.resolved?"subscribe active":"subscribe",onClick:function(){!function(e){var t="?post&args=".concat(encodeURIComponent(JSON.stringify({topic_id:e.id}))),n=e.resolved?"unresolve":"resolve";fetch("".concat(window.helpdesk.api.url,"/bbp/topic/resolve").concat(t),{method:"post",body:JSON.stringify({topic_id:e.id,action:n,token:zo("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){if(e.status){var t=To({},topics);t.resolved=!t.resolved,r(t)}e.hasOwnProperty("message")&&Bo("vibebp").addNotification({text:e.message})}))}(n)}},(n.resolved,window.helpdesk.translations.resolved)):""))),wp.element.createElement("div",{className:"vibebp_main_topic_description"},wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:n.post_content}})),c.length>5?wp.element.createElement("a",{href:"#new_reply",className:"button is-primary"},window.helpdesk.translations.add_reply):"",y?wp.element.createElement("a",{className:"link",onClick:function(){var e=To({},g);e.paged=g.paged+1,E(e)}},window.helpdesk.translations.load_previous_replies):"",wp.element.createElement("div",{className:"vibe_helpdesk_topic_replies"},c.length?c.sort((function(e,t){return e.id-t.id})).map((function(e,t){if(parseInt(e.id)!==parseInt(e.topic_id))return wp.element.createElement(Y,{key:"rep_"+t,reply:e,delete:function(){var e=Io(c);e.splice(t,1),s(e)}})})):"",m?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):""),wp.element.createElement(M,{reply:b,update:function(e){var t=Io(c);t.unshift(e),s(t),I(!1)},close:function(){return I(!1)}})),P.topic?wp.element.createElement("div",{className:"topic_extended_info"},wp.element.createElement("div",null,wp.element.createElement("a",{className:"button is-primary",style:{width:"100%"},onClick:function(){return N(To(To({},P),{},{user:!P.user}))}},P.user?window.helpdesk.translations.hide_user_info:window.helpdesk.translations.show_user_info),P.user?wp.element.createElement(fo,{id:n.id,close:function(){return N({topic:!1,user:!1})}}):""),wp.element.createElement(Ao,{id:n.id})):"")))};function Yo(e){return Yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yo(e)}function Ko(e){return function(e){if(Array.isArray(e))return ea(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Wo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xo(Object(n),!0).forEach((function(t){Go(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Go(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Yo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Yo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Yo(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||Wo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wo(e,t){if(e){if("string"==typeof e)return ea(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ea(e,t):void 0}}function ea(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ta=wp.element,na=(ta.createElement,ta.useState),ra=wp.data,oa=ra.dispatch,aa=ra.select;function ia(e){var t=Qo(na(e.assigned_agents),2),n=t[0],r=t[1],o=Qo(na(!1),2),a=o[0],i=o[1],l=Qo(na(""),2),c=l[0],p=l[1],m=Qo(na([]),2),f=m[0],d=m[1],b=Qo(na({users:!1,assign:!1,unassign:!1}),2),v=b[0],y=b[1],w=Qo(na([]),2),h=w[0],g=w[1],E=Qo(na(null),2),O=E[0],_=E[1];s((function(){O&&O.abort();var e=new AbortController,t=O?{signal:e.signal}:{};if(_(e),c.length>2){y(Zo(Zo({},v),{},{users:!0}));var n=c.length?"?nocache":"";fetch("".concat(window.helpdesk.api.url,"/bbp/search").concat(n),Zo(Zo({method:"post"},t),{},{body:JSON.stringify({s:c,token:aa("vibebp").getToken()})})).then((function(e){return e.json()})).then((function(e){y(Zo(Zo({},v),{},{users:!1})),d(e.users?e.users:[])})).catch((function(e){y(Zo(Zo({},v),{},{users:!0}))}))}}),500,[c]);var j=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"assign",o=Ko("assign"===t?h:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]);if(o.length){var a={user_ids:o,action:t,topic_id:e.topic_id},i="?post&args=".concat(encodeURIComponent(JSON.stringify(Zo({},a))));y(Zo(Zo({},v),{},Go({},t,!0))),"unassign"===t&&r(Ko(n).filter((function(e){return!o.includes(e)}))),fetch("".concat(window.helpdesk.api.url,"/bbp/topics/assign_topic").concat(i),{method:"post",body:JSON.stringify(Zo(Zo({},a),{},{token:aa("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){y(Zo(Zo({},v),{},Go({},t,!1))),e.status&&"assign"===t&&(r([].concat(Ko(n),Ko(o))),g([])),e.hasOwnProperty("message")&&oa("vibebp").addNotification({text:e.message})})).catch((function(e){y(Zo(Zo({},v),{},{users:!0}))}))}};return wp.element.createElement("div",{className:"assign_user_wrapper"},wp.element.createElement("label",null,window.helpdesk.translations.assigned_agents),wp.element.createElement("div",{className:"assigned_user_wrapper"},n&&Array.isArray(n)&&n.map((function(e){return wp.element.createElement("span",{className:"assigned_user"},wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){j("unassign",[e])}}),wp.element.createElement(u,{type:"member",id:{user_id:parseInt(e)}}))})),a?wp.element.createElement("span",{className:"assign_agent_form"},wp.element.createElement("div",{className:v.users?"control vibebp_form_field is-loading":"control vibebp_form_field"},wp.element.createElement("input",{type:"text",placeholder:window.helpdesk.translations.search_u,onChange:function(e){return p(e.target.value)}}),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){return i(!a)}})),wp.element.createElement("div",{className:"fetched_users"},f?f.map((function(e){if(!n.includes(e.id))return wp.element.createElement("span",{className:h.includes(e.id)?"active":"",onClick:function(){var t=Ko(h),n=t.findIndex((function(t){return e.id===t}));-1===n?g([].concat(Ko(t),[e.id])):(t.splice(n,1),g(t))}},e.label)})):"",h.length?wp.element.createElement("a",{className:v.assign?"button is-primary vicon vicon-share is-loading":"button is-primary vicon vicon-share",onClick:function(){return j("assign")}}):"")):wp.element.createElement("span",{className:"vicon vicon-plus",onClick:function(){return i(!a)}})))}function la(e){return la="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},la(e)}function ca(e){return function(e){if(Array.isArray(e))return da(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||fa(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ua(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ua(Object(n),!0).forEach((function(t){pa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ua(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pa(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==la(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==la(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===la(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ma(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||fa(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fa(e,t){if(e){if("string"==typeof e)return da(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?da(e,t):void 0}}function da(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ba=wp.element,va=(ba.createElement,ba.useState),ya=ba.useEffect,wa=ba.Fragment,ha=ba.useContext,ga=wp.data,Ea=ga.dispatch,Oa=ga.select;const _a=function(e){var t,n,r=ma(va(!1),2),o=r[0],a=r[1],l=ma(va(e.forum),2),c=l[0],p=l[1],m=ma(va({type:e.type,sorter:"",paged:1,s:"",order:"DESC",priorities:[]}),2),f=m[0],d=m[1],b=ma(va([]),2),v=b[0],y=b[1],w=ma(va([]),2),h=w[0],g=w[1],E=ma(va(!1),2),O=E[0],_=E[1],j=ma(va(!1),2),S=j[0],k=j[1],P=ma(va(0),2),N=P[0],A=P[1],I=ma(va(!1),2),x=I[0],C=(I[1],ma(va(!1),2)),T=C[0],D=C[1],U=Oa("vibebp").getUser(),M=ma(va(null),2),L=M[0],R=M[1],$=ha(J),F=ma(va(!1),2),H=F[0],q=F[1];ya((function(){e.hasOwnProperty("forum")&&(p(e.forum),D(e.forum.subscribed))}),[e.forum]);var B=function(){d(sa(sa({},f),{},{s:""}))};ya((function(){return document.addEventListener("vibebp_component_reload",B),function(){document.removeEventListener("vibebp_component_reload",B)}})),ya((function(){var e;h.length&&null!==(e=$.path)&&void 0!==e&&e.hasOwnProperty("topic")&&A(h[h.findIndex((function(e){return e.id==$.path.topic}))])}),[$.path,h]),ya((function(){c&&Object.keys(c).length&&fetch("".concat(window.helpdesk.api.url,"/bbp/subforums?post"),{method:"post",body:JSON.stringify({forum_id:c.id,token:Oa("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status?y(e.forums):y([])}))}),[c]),s((function(){var t;L&&L.abort();var n=new AbortController,r=L?{signal:n.signal}:{};R(n),a(!0);var o=1==f.paged?[]:ca(h);g(o),_(!1);var i=sa(sa({},f),{},{type:e.type});("forum"===e.type||null!==(t=e.forum)&&void 0!==t&&t.hasOwnProperty("id"))&&(i.post_parent=c.id),e.label&&(i.label=e.label);var l=f.s.length?"?nocache":"?args=".concat(encodeURIComponent(JSON.stringify(i)));fetch("".concat(window.helpdesk.api.url,"/bbp/topics").concat(l),sa(sa({method:"post"},r),{},{body:JSON.stringify(sa(sa({},i),{},{token:Oa("vibebp").getToken()}))})).then((function(e){return e.json()})).then((function(e){if(a(!1),e.status){o=1==f.paged?[]:ca(h);var t=[].concat(ca(o),ca(e.topics));_(t.length<parseInt(e.total)),g(t)}}))}),500,[f,e.type,e.label,c]);var z=function(e){var t=ca(h),n="?post&args=".concat(encodeURIComponent(JSON.stringify({topic_id:e.id})));fetch("".concat(window.helpdesk.api.url,"/bbp/topics/delete").concat(n),{method:"post",body:JSON.stringify({topic_id:e.id,token:Oa("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(n){n.status&&(t.splice(t.findIndex((function(t){return e.id==t.id})),1),g(t),A(!1)),n.hasOwnProperty("message")&&Ea("vibebp").addNotification({text:n.message})}))},V=function(e){var t="?post&args=".concat(encodeURIComponent(JSON.stringify({topic_id:h[e].id})));fetch("".concat(window.helpdesk.api.url,"/bbp/topics/subscribe").concat(t),{method:"post",body:JSON.stringify({topic_id:h[e].id,subscribe:!h[e].subscribed,token:Oa("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.status){var n=ca(h);n[e].subscribed=!n[e].subscribed,g(n)}else t.hasOwnProperty("message")&&Ea("vibebp").addNotification({text:t.message})}))},Y=ca(h);return f.s.length&&(Y=h.filter((function(e){return e.post_title.toLowerCase().indexOf(f.s.toLowerCase())>-1}))),wp.element.createElement("div",{className:"vibebp_topics"},e.hasOwnProperty("forum")?wp.element.createElement("div",{className:"vibebp_topics_header"},wp.element.createElement("span",{onClick:e.back},e.single?"":wp.element.createElement(wa,null,wp.element.createElement("span",{className:"vicon vicon-arrow-left"}),wp.element.createElement("span",null,window.helpdesk.translations.back_to_all_topics),wp.element.createElement("span",{className:"vicon vicon-angle-left"})),wp.element.createElement("span",null,c?c.title:"")),wp.element.createElement("span",{className:T?"subscribe active":"subscribe",onClick:function(){var e;e="?post&args=".concat(encodeURIComponent(JSON.stringify({forum_id:c.id}))),fetch("".concat(window.helpdesk.api.url,"/bbp/topics/subscribe").concat(e),{method:"post",body:JSON.stringify({forum_id:c.id,subscribe:!T,token:Oa("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&D(!T)}))}},T?window.helpdesk.translations.subscribed:window.helpdesk.translations.subscribe)):"",N?"":wp.element.createElement("div",{className:"vibebp_full_topics_header"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("div",{className:x?"search_me control is-loading":"search_me"},wp.element.createElement("input",{type:"text",onBlur:function(e){d({paged:1,s:e.target.value})},placeholder:window.helpdesk.translations.search_topics}),wp.element.createElement("span",{className:"vicon vicon-search"}))),!S&&e.hasOwnProperty("forum")&&null!==(t=e.forum)&&void 0!==t&&t.hasOwnProperty("id")?wp.element.createElement("a",{className:"button is-primary",onClick:function(){q(!0)}},window.helpdesk.translations.new_topic):""),N?wp.element.createElement(Vo,{topic:N,back:function(){A(!1)},update:function(e){var t=ca(h),n=t.findIndex((function(t,n){return t.id==e.id}));n>-1?t.splice(n,1,e):t.push(e),g(t)},delete:z}):S?wp.element.createElement(oo,{back:function(e){k(!1),e&&d(sa({},f))},topic:h[S]}):wp.element.createElement(wa,null,H?wp.element.createElement(oo,{forum_id:e.hasOwnProperty("forum")&&null!==(n=e.forum)&&void 0!==n&&n.hasOwnProperty("id")?c.id:null,back:function(e){q(!1),console.log("######",e),e&&d(sa({},f))}}):"",v.length?v.map((function(e){return wp.element.createElement("div",{className:"vibebp_forum"},wp.element.createElement("div",{className:"vibebp_forum_details"},wp.element.createElement("strong",{onClick:function(){e.access&&($.update("path",sa(sa({},$.path),{},{forum:e.id})),p(e))}},wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:e.title}})),wp.element.createElement("div",{className:"vibebp_forum_description",dangerouslySetInnerHTML:{__html:e.description}}),wp.element.createElement("div",{className:"vibebp_forum_meta"},e.subscribed?wp.element.createElement("span",{onClick:function(){V(i)},className:"active subscribe"},window.helpdesk.translations.subscribed):wp.element.createElement("span",{onClick:function(){V(i)},className:"subscribe"},window.helpdesk.translations.subscribe),wp.element.createElement("span",{className:"vibebp_topic_count tip",title:window.helpdesk.translations.topic_count},wp.element.createElement("span",{className:"vicon vicon-comment"}),e.topic_count),wp.element.createElement("span",{className:"vibebp_topic_count tip",title:window.helpdesk.translations.reply_count},wp.element.createElement("span",{className:"vicon vicon-comments"}),e.post_count),e.access?wp.element.createElement("span",{className:"tip",title:window.helpdesk.translations.accssible_forum},wp.element.createElement("span",{className:"vicon vicon-eye"})):wp.element.createElement("span",{className:"tip",title:window.helpdesk.translations.hidden_forum},wp.element.createElement("span",{className:"vicon vicon-na"})),e.forums_count?wp.element.createElement("span",{className:"tip",title:window.helpdesk.translations.sub_forum},wp.element.createElement("span",{className:"vicon vicon-folder"})," ",e.forums_count):"")))})):"",Y.length?Y.map((function(t,n){return wp.element.createElement("div",{className:"vibebp_topic_wrapper"},wp.element.createElement(u,{type:"member",id:{user_id:t.author}}),wp.element.createElement("div",{className:"vibebp_topic"},wp.element.createElement("div",{className:"vibebp_topic_title"},wp.element.createElement("strong",{onClick:function(){A(t)}},wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:t.post_title}})),wp.element.createElement("span",null,wp.element.createElement("span",{className:t.favorite?"vicon vicon-star active":"vicon vicon-star",onClick:function(){!function(e){var t="?post&args=".concat(encodeURIComponent(JSON.stringify({topic_id:e.id})));e.favorite?fetch("".concat(window.helpdesk.api.url,"/bbp/topics/unfavorite").concat(t),{method:"post",body:JSON.stringify({topic_id:e.id,token:Oa("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.status){var n=ca(h);n[n.findIndex((function(t){return t.id===e.id}))].favorite=!1,g(n)}t.hasOwnProperty("message")&&Ea("vibebp").addNotification({text:t.message})})):fetch("".concat(window.helpdesk.api.url,"/bbp/topics/favorite").concat(t),{method:"post",body:JSON.stringify({topic_id:e.id,token:Oa("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.status){var n=ca(h);n[n.findIndex((function(t){return t.id===e.id}))].favorite=!0,g(n)}t.hasOwnProperty("message")&&Ea("vibebp").addNotification({text:t.message})}))}(t)}}),wp.element.createElement("span",{className:t.subscribed?"subscribe active":"subscribe",onClick:function(){V(n)}},t.subscribed?window.helpdesk.translations.subscribed:window.helpdesk.translations.subscribe),t.is_resolved?wp.element.createElement("span",{className:"subscribe active"},window.helpdesk.translations.resolved):"","assigned"===e.type||"resolved"===e.type||e.can_assign?wp.element.createElement("span",{className:t.resolved?"subscribe active":"subscribe",onClick:function(){!function(e){var t="?post&args=".concat(encodeURIComponent(JSON.stringify({topic_id:h[e].id}))),n=h[e].resolved?"unresolve":"resolve";fetch("".concat(window.helpdesk.api.url,"/bbp/topic/resolve").concat(t),{method:"post",body:JSON.stringify({topic_id:h[e].id,action:n,token:Oa("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.status){var n=ca(h);n[e].resolved=!n[e].resolved,g(n)}t.hasOwnProperty("message")&&Ea("vibebp").addNotification({text:t.message})}))}(n)}},(t.resolved,window.helpdesk.translations.resolved)):"",wp.element.createElement("span",{className:"vicon vicon-comment-alt",onClick:function(){A(t)}}),wp.element.createElement("strong",{onClick:function(){A(t)}},t.reply_count))),wp.element.createElement("div",{className:"vibebp_topic_actions"},wp.element.createElement("a",{href:t.permalink,target:"_blank",className:"vicon vicon-link"}),wp.element.createElement("span",null,wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:t.last_update}})),U.id===parseInt(t.author)?wp.element.createElement(wa,null,wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){k(n)}}),wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){z(t)}})):""),"unassigned"==e.type||"recent_assigned"==e.type?wp.element.createElement(ia,{assigned_agents:t.assigned_agents,topic_id:t.id}):""))})):wp.element.createElement("div",{className:"vbp_message"},window.helpdesk.translations.no_topics_found),o?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",O?wp.element.createElement("a",{className:"link",onClick:function(){_(!1);var e=sa({},f);e.paged=f.paged+1,d(e)}},window.helpdesk.translations.more):""))};function ja(e){return ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ja(e)}function Sa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ka(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sa(Object(n),!0).forEach((function(t){Pa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pa(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ja(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ja(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ja(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Na(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Aa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Aa(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Aa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ia=wp.element,xa=(Ia.createElement,Ia.useState),Ca=Ia.useEffect,Ta=(Ia.useContext,Ia.Fragment,wp.data),Da=Ta.dispatch,Ua=Ta.select;const Ma=function(e){var t=Na(xa(!1),2),n=(t[0],t[1]),r=Na(xa([]),2),o=(r[0],r[1],Na(xa([]),2)),a=o[0],i=o[1],l=Na(xa({id:e.forum_id?e.forum_id:0,post_title:"",post_content:"",parent_id:0,meta:[]}),2),c=l[0],u=l[1],s=Na(xa({raw:{},content:{}}),2),p=s[0],m=s[1],f=Na(xa(null),2);f[0],f[1],Ca((function(){fetch("".concat(window.helpdesk.api.url,"/bbp/forums/create_fields?post"),{method:"post",body:JSON.stringify({forum_id:c.id,token:Ua("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&i(e.fields)}))}),[]);var d=function(e,t){var n=e.field;if("fieldvaluechanged"==t){if("post"==n.from)if("editor"==n.type)m({post_content:n.value,raw:n.raw});else{var r=ka({},c);r[n.id]=n.value,u(r)}if("meta"==n.from){var o=ka({},c),a=o.meta.findIndex((function(e){return e.meta_key==n.id}));a>-1?o.meta[a].meta_value=n.value:o.meta.push({meta_key:n.id,meta_value:n.value}),u(o)}if("taxonomy"==n.from){var i=ka({},c),l=i.taxonomy.findIndex((function(e){return e.taxonomy==n.id}));l>-1?i.taxonomy[l].value=n.value:i.taxonomy.push({taxonomy:n.id,terms:n.value}),u(i)}}};return wp.element.createElement("div",{className:"vibebp_new_topic"},wp.element.createElement("div",{className:"vibebp_new_topic_header"},wp.element.createElement("span",{className:"vicon vicon-arrow-left",onClick:function(){return e.back()}}),wp.element.createElement("div",{className:"vibebp_topic_actions"},c&&c.hasOwnProperty("post_title")?wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){u(ka(ka({},c),{},{post_title:"",post_content:""}))}}):"")),wp.element.createElement("div",{className:"vibebp_new_forum"},a.length?a.map((function(e,t){return wp.element.createElement("div",{className:e.style},wp.element.createElement(Br,{field:e,update:d}))})):wp.element.createElement(Ft,null)),wp.element.createElement("div",{className:"new_forum_buttons"},wp.element.createElement("a",{className:"button is-primary",onClick:function(){n(!0);var t="?post&args=".concat(encodeURIComponent(JSON.stringify(ka({},c))));fetch("".concat(window.helpdesk.api.url,"/bbp/forums/create").concat(t),{method:"post",body:JSON.stringify(ka(ka(ka({},c),p),{},{token:Ua("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(t){n(!1),t.status&&e.back("reload"),t.hasOwnProperty("message")&&Da("vibebp").addNotification({text:t.message})}))}},window.helpdesk.translations.create_forum),wp.element.createElement("a",{className:"link",onClick:e.back},window.vibebp.translations.cancel)))};function Ja(e){return Ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ja(e)}function La(e){return function(e){if(Array.isArray(e))return Ba(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||qa(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ra(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ra(Object(n),!0).forEach((function(t){Fa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ra(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fa(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ja(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ja(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ja(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ha(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||qa(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qa(e,t){if(e){if("string"==typeof e)return Ba(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ba(e,t):void 0}}function Ba(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var za=wp.element,Va=(za.createElement,za.useState),Ya=za.useEffect,Ka=za.Fragment,Xa=(za.render,za.useContext),Za=wp.data,Ga=Za.dispatch,Qa=Za.select;const Wa=function(e){var t=Ha(Va(!0),2),n=t[0],r=t[1],o=Ha(Va([]),2),a=o[0],i=o[1],l=Ha(Va(!1),2),c=l[0],u=l[1],p=Ha(Va({paged:1,s:""}),2),m=p[0],f=p[1],d=Ha(Va(!1),2),b=d[0],v=d[1],y=Ha(Va(!1),2),w=y[0],h=(y[1],Ha(Va(null),2)),g=h[0],E=h[1],O=Ha(Va(!1),2),_=O[0],j=O[1],S=Xa(J);Ya((function(){if("forums"==Qa("vibebp").getAction()&&Qa("vibebp").getId()){var e=Qa("vibebp").getId();e&&f($a($a({},m),{},{post__in:[e]}))}}),[]);var k=function(){f($a($a({},m),{},{s:""}))};Ya((function(){return document.addEventListener("vibebp_component_reload",k),function(){document.removeEventListener("vibebp_component_reload",k)}})),s((function(){g&&g.abort();var e=new AbortController,t=g?{signal:e.signal}:{};E(e),r(!0);var n=m.s.length?"?nocache":"?args=".concat(encodeURIComponent(JSON.stringify($a($a({},m),{},{s:""})))),o=1==m.paged?[]:La(a);i(o),fetch("".concat(window.helpdesk.api.url,"/bbp/forums").concat(n),$a($a({method:"post"},t),{},{body:JSON.stringify($a($a({},m),{},{token:Qa("vibebp").getToken()}))})).then((function(e){return e.json()})).then((function(e){if(r(!1),e.status&&e.forums){o=1==m.paged?[]:La(a);var t=[].concat(La(o),La(e.forums));i(t),v(t.length<parseInt(e.total))}})).catch((function(e){r(!1),"AbortError"===e.name||(E(null),console.error("Uh oh, an error!",e))}))}),500,[m]);var P=function(e){var t={subscribe:!a[e].subscribed,forum_id:a[e].id},n="?post&args=".concat(encodeURIComponent(JSON.stringify($a({},m))));fetch("".concat(window.helpdesk.api.url,"/bbp/forums/subscribe").concat(n),{method:"post",body:JSON.stringify($a($a({},t),{},{token:Qa("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(t){if(t.status){var n=La(a);n[e].subscribed=!a[e].subscribed,i(n)}else t.hasOwnProperty("message")&&Ga("vibebp").addNotification({text:t.message})}))},N=La(a);return m.s.length&&(N=a.filter((function(e){return e.title.toLowerCase().indexOf(m.s.toLowerCase())>-1}))),Ya((function(){var e;N.length&&null!==(e=S.path)&&void 0!==e&&e.hasOwnProperty("forum")&&N.findIndex((function(e){return e.id==S.path.forum}))>-1&&u(N[N.findIndex((function(e){return e.id==S.path.forum}))])}),[S.path,N]),wp.element.createElement("div",{className:"vibebp_forums"},c?wp.element.createElement(_a,{type:"forum",forum:c,back:function(){if(u(!1),S.update("path",{}),m.post__in){var e=$a({},m);delete e.post__in,f(e)}}}):wp.element.createElement(Ka,null,wp.element.createElement("div",{className:"vibebp_forums_header"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("div",{className:w?"search_me control is-loading":"search_me"},wp.element.createElement("input",{type:"text",onBlur:function(e){f({paged:1,s:e.target.value})},placeholder:window.helpdesk.translations.search_forums}),wp.element.createElement("span",{className:"vicon vicon-search"}))),window.helpdesk.settings.create_forum==Qa("vibebp").getUser().member_type||Qa("vibebp").getUser().caps.manage_options?wp.element.createElement("a",{className:"button is-primary",onClick:function(){return j(!0)}},wp.element.createElement("span",null,window.helpdesk.translations.new_forum),wp.element.createElement("span",{className:"vicon vicon-plus"})):"",wp.element.createElement("div",null,wp.element.createElement("select",{value:m.order,onChange:function(e){return f($a($a({},m),{},{orderby:e.target.value}))}},wp.element.createElement("option",null,window.helpdesk.translations.sort_by),wp.element.createElement("option",{value:"most_active"},window.helpdesk.translations.most_active),wp.element.createElement("option",{value:"alphabetical"},window.helpdesk.translations.alphbetical),wp.element.createElement("option",{value:"alphabetical"},window.helpdesk.translations.recency)),wp.element.createElement("span",{className:"ASC"==m.order?"vicon vicon-arrow-up active":"vicon vicon-arrow-up",onClick:function(){return f($a($a({},m),{},{order:"ASC"}))}}),wp.element.createElement("span",{className:"ASC"==m.order?"vicon vicon-arrow-down active":"vicon vicon-arrow-down",onClick:function(){return f($a($a({},m),{},{order:"DESC"}))}}))),wp.element.createElement("div",{className:"vibebp_forums_list"},n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):_?wp.element.createElement(Ma,{back:function(e){e&&f($a($a({},m),{},{s:""})),j(!1)}}):wp.element.createElement(Ka,null,N.length?N.map((function(e,t){return wp.element.createElement("div",{className:"vibebp_forum"},wp.element.createElement("div",{className:"vibebp_forum_details"},wp.element.createElement("strong",{onClick:function(){e.access&&S.update("path",$a($a({},S.path),{},{forum:e.id}))}},wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:e.title}})),wp.element.createElement("div",{className:"vibebp_forum_description",dangerouslySetInnerHTML:{__html:e.description}}),wp.element.createElement("div",{className:"vibebp_forum_meta"},e.subscribed?wp.element.createElement("span",{onClick:function(){P(t)},className:"active subscribe"},window.helpdesk.translations.subscribed):wp.element.createElement("span",{onClick:function(){P(t)},className:"subscribe"},window.helpdesk.translations.subscribe),wp.element.createElement("span",{className:"vibebp_topic_count tip",title:window.helpdesk.translations.topic_count},wp.element.createElement("span",{className:"vicon vicon-comment"}),e.topic_count),wp.element.createElement("span",{className:"vibebp_topic_count tip",title:window.helpdesk.translations.reply_count},wp.element.createElement("span",{className:"vicon vicon-comments"}),e.post_count),e.access?wp.element.createElement("span",{className:"tip",title:window.helpdesk.translations.accssible_forum},wp.element.createElement("span",{className:"vicon vicon-eye"})):wp.element.createElement("span",{className:"tip",title:window.helpdesk.translations.hidden_forum},wp.element.createElement("span",{className:"vicon vicon-na"})),e.forums_count?wp.element.createElement("span",{className:"tip",title:window.helpdesk.translations.sub_forum},wp.element.createElement("span",{className:"vicon vicon-folder"})," ",e.forums_count):"")))})):wp.element.createElement("div",{className:"vbp_message"},window.helpdesk.translations.no_forums_found))),b?wp.element.createElement("a",{className:"link",onClick:function(){var e=$a({},m);e.paged=m.paged+1,f(e)}},window.helpdesk.translations.more):""))};function ei(e){return ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ei(e)}function ti(e){return function(e){if(Array.isArray(e))return li(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ii(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ni(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ri(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ni(Object(n),!0).forEach((function(t){oi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ni(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oi(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ei(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ei(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ei(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ai(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||ii(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ii(e,t){if(e){if("string"==typeof e)return li(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?li(e,t):void 0}}function li(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ci=wp.element,ui=(ci.createElement,ci.useState),si=ci.useEffect,pi=ci.Fragment,mi=(ci.render,wp.data),fi=(mi.dispatch,mi.select);const di=function(e){var t=ai(ui({type:e.type,sorter:"",paged:1,s:"",order:"DESC"}),2),n=t[0],r=t[1],o=ai(ui(!1),2),a=o[0],i=o[1],l=ai(ui([]),2),c=l[0],u=l[1],p=ai(ui(!0),2),m=(p[0],p[1]),f=ai(ui(!1),2),d=f[0],b=f[1],v=ai(ui(0),2),y=v[0],w=v[1],h=ai(ui(!1),2),g=h[0],E=(h[1],ai(ui(null),2)),O=E[0],_=E[1],j=function(){r(ri(ri({},n),{},{s:""}))};si((function(){return document.addEventListener("vibebp_component_reload",j),function(){document.removeEventListener("vibebp_component_reload",j)}})),s((function(){O&&O.abort();var e=new AbortController,t=O?{signal:e.signal}:{};_(e),i(!0);var r=n.s.length?"?nocache":"?args=".concat(encodeURIComponent(JSON.stringify(ri(ri({},n),{},{s:""})))),o=1!=n.paged||n.s?ti(c):[];u(o),fetch("".concat(window.helpdesk.api.url,"/bbp/replies").concat(r),ri(ri({method:"post"},t),{},{body:JSON.stringify(ri(ri({},n),{},{token:fi("vibebp").getToken()}))})).then((function(e){return e.json()})).then((function(e){if(i(!1),e.status){o=1==n.paged?[]:ti(c);var t=[].concat(ti(o),ti(e.replies));b(t.length<parseInt(e.total)),u(t)}})).catch((function(e){i(!1),"AbortError"===e.name||(_(null),console.error("Uh oh, an error!",e))}))}),500,[n]);var S=function(){},k=ti(c).sort((function(e,t){return t.id-e.id}));return n.s.length&&(k=c.filter((function(e){return e.post_content.toLowerCase().indexOf(n.s.toLowerCase())>-1}))),si((function(){document.dispatchEvent(new Event("VibeBP_Editor_Content"))}),[c]),wp.element.createElement(pi,null,y?wp.element.createElement(Vo,{topic:y,back:function(){w(!1)}}):wp.element.createElement("div",{className:"vibebp_replies"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("div",{className:g?"search_me control is-loading":"search_me"},wp.element.createElement("input",{type:"text",value:n.s,onChange:function(e){r({paged:1,s:e.target.value})},placeholder:window.helpdesk.translations.search_replies}),wp.element.createElement("span",{className:"vicon vicon-search"}))),k&&k.length?k.map((function(e,t){return wp.element.createElement(Y,{reply:e,update:S,open:function(){w(e.topic_id)},delete:function(){var t=ti(c),n=c.findIndex((function(t){return t.id===e.id}));n>-1&&(t.splice(n,1),k=ti(t),u(t))}})})):wp.element.createElement("div",{className:"vbp_message"},window.helpdesk.translations.no_replies_found),a?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",d?wp.element.createElement("a",{className:"link",onClick:function(){b(!1);var e=ri({},n);e.paged=n.paged+1,m(!0),r(e)}},window.helpdesk.translations.more):""))};function bi(e){return bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bi(e)}function vi(){return vi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vi.apply(this,arguments)}function yi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yi(Object(n),!0).forEach((function(t){hi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hi(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==bi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==bi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===bi(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ei=wp.element.useState;const Oi=function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return gi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Ei({scope:Object.keys(window.helpdesk.settings.shared_tabs)[0]}),2),n=t[0],r=t[1];return wp.element.createElement("div",{className:"vibe_assign_topic_wrapper"},wp.element.createElement("div",{className:"vibe_assign_topic_header"},wp.element.createElement("div",{class:"buttons has-addons"},Object.keys(window.helpdesk.settings.shared_tabs).map((function(e){return wp.element.createElement("button",{className:n.scope==e?"button is-success is-selected":"button",onClick:function(t){r(wi(wi({},n),{},{scope:e}))}},window.helpdesk.settings.shared_tabs[e])})))),"unassigned"===n.scope?wp.element.createElement(_a,vi({type:"unassigned"},e)):wp.element.createElement(_a,vi({type:"recent_assigned"},e)))};function _i(e){return _i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_i(e)}function ji(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Si(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ji(Object(n),!0).forEach((function(t){ki(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ji(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ki(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==_i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==_i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===_i(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ni(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ni(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ni(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ai=wp.element,Ii=(Ai.createElement,Ai.useState),xi=Ai.useEffect,Ci=wp.data,Ti=Ci.dispatch,Di=Ci.select;const Ui=function(e){var t=Pi(Ii({id:"",post_title:""}),2),n=t[0],r=t[1],o=Pi(Ii({post_content:"",raw:""}),2),a=o[0],i=o[1],l=Pi(Ii("new_canned"),2),c=l[0],u=(l[1],Pi(Ii({saving:!1,search:!1}),2)),s=u[0],p=u[1];return xi((function(){if(e.response&&e.response.hasOwnProperty("ID")){var t=Si(Si({},n),e.response);t.id=e.response.ID,r(t)}}),[e.response]),xi((function(){var t=new CustomEvent("load_vibe_editor",{detail:{selector:".".concat(c),content:e.hasOwnProperty("response")&&e.response.post_content?e.response.post_content:"",raw:e.hasOwnProperty("response")&&e.response.raw?e.response.raw:"",components:"editor",updater:c}});document.dispatchEvent(t);var n=function(e){i(Si(Si({},a),{},{post_content:e.detail.raw_html,raw:e.detail.editor_content}))};return document.addEventListener("vibe_editor_content_update_".concat(c),n),function(){document.removeEventListener("vibe_editor_content_update_".concat(c),n)}}),[]),wp.element.createElement("div",{className:"vhd_sidebar"},wp.element.createElement("div",{className:"new_vhd_sidebar_overlay",onClick:e.close}),wp.element.createElement("div",{className:"new_vhd_sidebar_wrapper vibebp_form"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("label",null,window.helpdesk.translations.enter_canned_title),wp.element.createElement("input",{value:n.post_title,placeholder:window.helpdesk.translations.enter_canned_title,onChange:function(e){return r(Si(Si({},n),{},{post_title:e.target.value}))}})),wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("label",null,window.helpdesk.translations.enter_canned_content),wp.element.createElement("div",{className:c})),wp.element.createElement("div",{className:"form_action"},n.post_title&&a.post_content&&a.post_content.length?wp.element.createElement("a",{className:s.saving?"is-loading button is-primary vicon vicon-save":"button is-primary vicon vicon-save",onClick:function(){if(a.post_content&&n.post_title){p(Si(Si({},s),{},{saving:!0}));var t=Si(Si({},n),a),r="?args=".concat(encodeURIComponent(JSON.stringify(Si({},t))));fetch("".concat(window.helpdesk.api.url,"/bbp/replies/save_canned").concat(r),{method:"post",body:JSON.stringify(Si(Si({},t),{},{token:Di("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(t){p(Si(Si({},s),{},{saving:!1})),t.status&&(t.data.raw=a.raw,e.update&&e.update(t.data)),t.hasOwnProperty("message")&&Ti("vibebp").addNotification({text:t.message})})).catch((function(e){console.log(e),p(Si(Si({},s),{},{saving:!1}))}))}}}):""),wp.element.createElement("a",{className:"link",onClick:e.close},window.helpdesk.translations.cancel)))};function Mi(e){return Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mi(e)}function Ji(e){return function(e){if(Array.isArray(e))return qi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Hi(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Li(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ri(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Li(Object(n),!0).forEach((function(t){$i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Li(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Mi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Mi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Mi(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||Hi(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hi(e,t){if(e){if("string"==typeof e)return qi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qi(e,t):void 0}}function qi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Bi=wp.element,zi=(Bi.createElement,Bi.useState),Vi=wp.data,Yi=Vi.dispatch,Ki=Vi.select;const Xi=function(){var e=Fi(zi({paged:1,s:"",orderby:"date",order:"DESC"}),2),t=e[0],n=e[1],r=Fi(zi(null),2),o=r[0],a=r[1],i=Fi(zi([]),2),l=i[0],c=i[1],u=Fi(zi(!1),2),p=u[0],m=u[1],f=Fi(zi(!1),2),d=f[0],b=f[1],v=Fi(zi(!1),2),y=v[0],w=v[1];s((function(){o&&o.abort();var e=new AbortController,n=o?{signal:e.signal}:{};a(e);var r=Ri({},t),i=r.s.length?"?nocache":"?args=".concat(encodeURIComponent(JSON.stringify(Ri(Ri({},r),{},{s:""})))),c=1==r.paged?[]:Ji(l);h(c),m(!0),fetch("".concat(window.helpdesk.api.url,"/bbp/users/canned-responses").concat(i," "),Ri(Ri({method:"post"},n),{},{body:JSON.stringify(Ri(Ri({},t),{},{token:Ki("vibebp").getToken()}))})).then((function(e){return e.json()})).then((function(e){if(m(!1),e.status){c=1==t.paged?[]:Ji(l);var n=[].concat(Ji(c),Ji(e.data));b(n.length<parseInt(e.total)),h(n)}})).catch((function(e){m(!1),"AbortError"!==e.name&&(a(null),console.error("Uh oh, an error!",e))}))}),500,[t]);var h=function(e){c(e)};return wp.element.createElement("div",{className:"canned_responses_wrapper"},wp.element.createElement("div",{className:"new_button_wrapper"},y?wp.element.createElement(Ui,{update:function(e){var t=Ji(l),n=t.findIndex((function(t){return t.ID===e.ID}));n>-1?t.splice(n,1,e):t.unshift(e),c(t)},response:y,close:function(){return w(!1)}}):wp.element.createElement("div",{className:"new_button"},wp.element.createElement("a",{className:"button is-primary vicon vicon-plus",onClick:function(){return w(!0)}}))),p?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",l&&l.length?wp.element.createElement("div",{className:"canned_all_responses_wrapper"},l.map((function(e,t){return wp.element.createElement("div",{className:"canned_reponse_wrapper"},wp.element.createElement("div",{className:"canned_reponse_wrapper_header"},wp.element.createElement("div",{className:"response_date"},new Date(e.post_date).toLocaleDateString()),wp.element.createElement("div",{className:"canned_actions"},wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){return function(e){w(l[e])}(t)}}),wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){return function(e){var t=Ji(l),n=Ji(l);n.splice(e,1),c(n),fetch("".concat(window.helpdesk.api.url,"/bbp/users/canned-responses/delete"),{method:"post",body:JSON.stringify({id:l[e].ID,token:Ki("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status||c(t),e.hasOwnProperty("message")&&Yi("vibebp").addNotification({text:e.message})})).catch((function(e){c(t),"AbortError"!==e.name&&console.error("Uh oh, an error!",e)}))}(t)}}))),wp.element.createElement("div",null,e.post_title))}))):wp.element.createElement("div",{className:"vbp_message"},window.helpdesk.translations.no_responses),d?wp.element.createElement("a",{className:"link",onClick:function(){n(Ri(Ri({},t),{},{paged:t.paged+1}))}},window.helpdesk.translations.load_more):"")};function Zi(e){return Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zi(e)}function Gi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gi(Object(n),!0).forEach((function(t){Wi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wi(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Zi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Zi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Zi(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function el(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return tl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tl(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var nl=wp.element,rl=(nl.createElement,nl.useState),ol=nl.useEffect,al=wp.data,il=al.dispatch,ll=al.select;const cl=function(){var e=el(rl({post_content:"",raw:""}),2),t=e[0],n=e[1],r=el(rl({}),2),o=r[0],a=r[1],i=el(rl(!1),2),l=i[0],c=i[1],u=el(rl(!1),2),s=u[0],p=u[1],m="vibe_info_editor_",f=function(e){a({post_content:e.detail.raw_html,raw:e.detail.editor_content})};return ol((function(){p(!0),fetch("".concat(window.helpdesk.api.url,"/bbp/user-info"),{method:"post",body:JSON.stringify({token:ll("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){if(p(!1),e.info){n(e.info);var t=e.info,r=new CustomEvent("load_vibe_editor",{detail:{selector:".".concat(m),content:t.hasOwnProperty("post_content")&&t.post_content?t.post_content:"",raw:t.hasOwnProperty("raw")&&t.raw?t.raw:"",components:"editor",updater:"".concat(m)}});document.dispatchEvent(r),document.addEventListener("vibe_editor_content_update_".concat(m),f)}e.hasOwnProperty("message")&&il("vibebp").addNotification({text:e.message})}))}),[]),wp.element.createElement("div",{className:"myinfo_wrapper"},s?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",wp.element.createElement("div",{style:{display:s?"none":"block"}},wp.element.createElement("div",{className:"".concat(m)},wp.element.createElement("textarea",{onChange:function(e){n(Qi(Qi({},t),{},{post_content:e.target.value})),a(Qi(Qi({},o),{},{post_content:e.target.value}))},value:t.post_content})),wp.element.createElement("div",{className:"vibebp_info_form_actions"},wp.element.createElement("div",{className:"vibebp_info_form_buttons"},o.post_content?wp.element.createElement("a",{className:l?"button is-primary is-loading":"button is-primary",onClick:function(){c(!0),fetch("".concat(window.helpdesk.api.url,"/bbp/user-info/create?post"),{method:"post",body:JSON.stringify(Qi(Qi({},t),{},{post_content:o.post_content,raw:o.raw,token:ll("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){c(!1),e.status,e.hasOwnProperty("message")&&il("vibebp").addNotification({text:e.message})}))}},window.helpdesk.translations.submit):""))))};function ul(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var sl=wp.element,pl=(sl.createElement,sl.useState),ml=wp.data.select;const fl=function(){var e=ml("vibebp").getUser(),t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ul(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ul(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(pl({isAgent:window.helpdesk.settings.agents_cap&&e.roles.includes(window.helpdesk.settings.agents_cap),isSupervisor:window.helpdesk.settings.supervisor_cap&&e.roles.includes(window.helpdesk.settings.supervisor_cap)}),2);return[t[0],t[1]]};function dl(e){return dl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dl(e)}function bl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bl(Object(n),!0).forEach((function(t){yl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yl(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==dl(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==dl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===dl(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||hl(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hl(e,t){if(e){if("string"==typeof e)return gl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gl(e,t):void 0}}function gl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var El=wp.element,Ol=(El.createElement,El.useState),_l=El.useEffect,jl=wp.data,Sl=(jl.dispatch,jl.select);const kl=function(e){var t=wl(Ol({path:{}}),2),n=t[0],r=t[1],o=wl(Ol({}),2),a=o[0],i=o[1],l=wl(Ol([]),2),c=l[0],u=l[1],s=wl(Ol(!1),2),p=s[0],m=s[1],f=wl(Ol("topics"),2),d=f[0],b=f[1],v=wl(Ol(""),2);return v[0],v[1],_l((function(){var e=Sl("vibebp").getMenu().filter((function(e){return"forums"===e.parent&&e.css_id&&"engagements"!=e.css_id}));u(e),d?e.findIndex((function(e){return e.css_id==d}))>-1&&e[e.findIndex((function(e){return e.css_id==d}))].class.push("current-menu-item"):-1==e[0].class.indexOf("current-menu-item")&&e[0].class.push("current-menu-item"),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar"),u(e)}),[]),_l((function(){window.location.href.split("#");var e=[],t={};window.location.href.replace(/[#&]+([^=&]+)=([^&]*)/gi,(function(t,n,r){e[n]=r})),Object.keys(e).map((function(n){"forum"==n&&(t.forum=e[n],b("forums")),"topic"==n&&(t.topic=e[n])})),Object.keys(t).length&&r(vl(vl({},n),{},{path:t}))}),[]),_l((function(){if(n.hasOwnProperty("path")){var e=window.location.href.split("#")[0]+"#",t=[],r=(window.location.href.replace(/[#&]+([^=&]+)=([^&]*)/gi,(function(e,n,r){t[n]=r})),"");Object.keys(t).map((function(e){"forum"!==e&&"topic"!==e&&(r+=e+"="+t[e])})),e+=r,n.path.hasOwnProperty("forum")&&(r.length&&(e+="&"),e+="forum="+n.path.forum),n.path.hasOwnProperty("topic")&&(e+="&topic="+n.path.topic),window.location.href!=e&&(window.location.href=e)}}),[n.path]),_l((function(){}),[]),wp.element.createElement("div",{className:"vibebp_sidebars"},wp.element.createElement("div",{className:"vibebp_left_sidebar_wrapper"},wp.element.createElement("div",{className:"vibebp_left_sidebar"},wp.element.createElement("h3",null,window.helpdesk.label),wp.element.createElement("a",{className:"button is-primary new_mail",onClick:function(){m(!0)}},window.helpdesk.translations.new_topic),wp.element.createElement("a",{className:"button is-link new_mail",onClick:function(){b("forums"),r(vl(vl({},n),{},{path:{}}))}},window.helpdesk.translations.all_forums),c.map((function(e,t){var n=e.class.join(" ")+" "+e.css_id;return wp.element.createElement("a",{className:n,onClick:function(n){var r=vl({},a);r.filter=e.css_id,r.paged=1,a.css_id!==r.filter&&i(r),b(e.css_id);var o,l=function(e){if(Array.isArray(e))return gl(e)}(o=c)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||hl(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),s=l.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}));l[s].class.splice(l[s].class.indexOf("current-menu-item"),1),l[t].class.push("current-menu-item"),u(l)}},e.name)})))),wp.element.createElement("div",{className:"vibebp_main"},wp.element.createElement(J.Provider,{value:vl(vl({},n),{},{update:function(e,t){var o=vl({},n);"remove"===e?delete o[t]:"full"==e?o=t:"multiple"==e?Object.keys(t).map((function(e){o[e]=t[e]})):o[e]=t,r(o)}})},p?wp.element.createElement(oo,{back:function(e){e&&b(d),m(!1)}}):"forums"===d?wp.element.createElement(Wa,null):"replies"===d?wp.element.createElement(di,{type:"mine"}):"assign"===d?wp.element.createElement(Oi,{can_assign:!0}):"my_info"===d?wp.element.createElement(cl,null):"canned"===d?wp.element.createElement(Xi,null):"topics"==d||"favorites"==d||"subscriptions"==d?wp.element.createElement(_a,{type:d}):wp.element.createElement("div",{className:d}))))};function Pl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Nl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nl(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Al=wp.element,Il=(Al.createElement,Al.useState),xl=Al.useEffect,Cl=(Al.Fragment,Al.useContext),Tl=wp.data,Dl=(Tl.dispatch,Tl.select);const Ul=function(e){var t=Pl(Il(!1),2),n=(t[0],t[1]),r=Pl(Il(null),2),o=r[0],a=r[1];return Cl(J),xl((function(){e.detail&&fetch("".concat(window.helpdesk.api.url,"/bbp/componentForum?post"),{method:"post",body:JSON.stringify({detail:e.detail,token:Dl("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){n(!1),e.status&&e.forum&&a(e.forum)}))}),[e.detail]),o?wp.element.createElement(_a,{forum:o,single:!0}):""};function Ml(e){return Ml="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ml(e)}function Jl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ll(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jl(Object(n),!0).forEach((function(t){Rl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Rl(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ml(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ml(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ml(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Fl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fl(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Hl=wp.element,ql=(Hl.createElement,Hl.useState),Bl=Hl.useEffect,zl=Hl.useRef,Vl=wp.data,Yl=Vl.dispatch,Kl=Vl.select,Xl=null;const Zl=function(e){var t=$l(fl(),2),n=t[0],r=(t[1],$l(ql({role:"student"}),2)),o=r[0],a=r[1],i=$l(ql({getting:!1}),2),l=i[0],c=i[1],u=$l(ql(null),2),s=u[0],p=u[1],m=zl(),f=$l(ql(),2),d=(f[0],f[1]);return Bl((function(){s&&s.abort();var e=new AbortController,t=s?{signal:e.signal}:{};p(e),o.role&&(c(Ll(Ll({},l),{},{getting:!0})),fetch("".concat(window.helpdesk.api.url,"/bbp/dashboard-widget/stats"),Ll(Ll({method:"post"},t),{},{body:JSON.stringify(Ll(Ll({},o),{},{token:Kl("vibebp").getToken()}))})).then((function(e){return e.json()})).then((function(e){if(c(Ll(Ll({},l),{},{getting:!1})),e.status&&e.data){var t=Ll({},e.data);if(d(e.data),Chart){null!=Xl&&Xl.destroy();var n=m.current.getContext("2d"),r={type:"pie",data:{labels:[window.helpdesk.translations.resolved_topics,window.helpdesk.translations.unresolved_topics],datasets:[{label:window.helpdesk.translations.helpdesk_stats,data:[t.resolved,t.total-t.resolved],backgroundColor:["rgb(54, 162, 235)","rgb(255, 99, 132)"],hoverOffset:4}]}};Xl=new Chart(n,r)}}e.hasOwnProperty("message")&&Yl("vibebp").addNotification({text:e.message})})).catch((function(e){console.log(e),c(Ll(Ll({},l),{},{saving:!1}))})))}),[o.role]),wp.element.createElement("div",{className:"helpdesk_dashboard_widget helpdesk_stats_wrapper vibebp_fomr"},wp.element.createElement("div",{className:"form_action"},n.isAgent||n.isSupervisor?wp.element.createElement("select",{value:o.role,onChange:function(e){return a(Ll(Ll({},o),{},{role:e.target.value}))}},wp.element.createElement("option",{value:""},window.helpdesk.translations.selectas),Object.keys(window.helpdesk.settings.user_roles).map((function(e){return"agent"===e&&!n.isAgent||"supervisor"===e&&!n.isSupervisor?"":wp.element.createElement("option",{value:e},window.helpdesk.settings.user_roles[e])}))):""),wp.element.createElement("canvas",{style:{display:l.getting?"none":"block"},ref:m}),l.getting?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"")};function Gl(e){return Gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gl(e)}function Ql(e){return function(e){if(Array.isArray(e))return oc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||rc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ec(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wl(Object(n),!0).forEach((function(t){tc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tc(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Gl(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Gl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Gl(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||rc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rc(e,t){if(e){if("string"==typeof e)return oc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oc(e,t):void 0}}function oc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ac=wp.element,ic=(ac.createElement,ac.useState),lc=ac.useEffect,cc=ac.useRef,uc=wp.data,sc=uc.dispatch,pc=uc.select,mc={responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:!0}}]},plugins:{legend:{position:"top"},title:{display:!0,text:"Chart.js Bar Chart"}}},fc=window.helpdesk.settings.months;const dc=function(e){var t=nc(fl(),2),n=t[0],r=(t[1],nc(ic({role:"student",start:(new Date).getTime()-6048e5,end:(new Date).getTime(),view:"yearly"}),2)),o=r[0],a=r[1],i=nc(ic({getting:!1}),2),l=i[0],c=i[1],u=nc(ic(null),2),s=u[0],p=u[1],m=nc(ic(),2),f=m[0],d=m[1];lc((function(){s&&s.abort();var e=new AbortController,t=s?{signal:e.signal}:{};if(p(e),o.role&&o.start&&o.end&&o.view&&o.start<=o.end){var n=ec({},o);if(("daily"===o.view||"weekly"===o.view)&&o.end-o.start>26784e5)return void sc("vibebp").addNotification({text:window.helpdesk.translations.select_max_one_month});c(ec(ec({},l),{},{getting:!0})),fetch("".concat(window.helpdesk.api.url,"/bbp/dashboard-widget/chart"),ec(ec({method:"post"},t),{},{body:JSON.stringify(ec(ec({},n),{},{token:pc("vibebp").getToken()}))})).then((function(e){return e.json()})).then((function(e){if(c(ec(ec({},l),{},{getting:!1})),e.status&&e.data){var t=ec({},e.data),n=b(t),r={borderColor:"rgb(54, 162, 235)",backgroundColor:"rgb(54, 162, 235)"},o=Ql(t.total),a=Ql(t.resolved),i=o.map((function(e){return parseInt(e.count)})),u=o.map((function(e){if(t.resolved&&t.resolved.length){var n=a.findIndex((function(t){return t.key1===e.key1&&t.key2===e.key2}));n>-1&&(e.count=parseInt(e.count)-parseInt(a[n].count))}return parseInt(e.count)})),s=o.map((function(e){if(a&&a.length){var t=a.findIndex((function(t){return t.key1===e.key1&&t.key2===e.key2}));if(t>-1)return parseInt(a[t].count)}return 0})),p={type:"bar",data:{labels:n.total,datasets:[ec(ec({label:window.helpdesk.translations.total_topics},r),{},{borderColor:window.helpdesk.settings.colors[0],backgroundColor:window.helpdesk.settings.colors[0],data:i}),ec(ec({label:window.helpdesk.translations.resolved_topics},r),{},{borderColor:window.helpdesk.settings.colors[1],backgroundColor:window.helpdesk.settings.colors[1],data:s}),ec(ec({label:window.helpdesk.translations.unresolved_topics},r),{},{borderColor:window.helpdesk.settings.colors[2],backgroundColor:window.helpdesk.settings.colors[2],data:u})]},options:mc};d(p)}e.hasOwnProperty("message")&&sc("vibebp").addNotification({text:e.message})})).catch((function(e){console.log(e),c(ec(ec({},l),{},{saving:!1}))}))}}),[o]);var b=function(e){var t={total:[]},n=Object.keys(t);return"daily"===o.view?n.map((function(n){e[n].forEach((function(e){t[n].push("".concat(e.key1," - ").concat(fc[e.key2-1]))}))})):"weekly"===o.view?n.map((function(n){e[n].forEach((function(e){t[n].push("".concat(e.key1,"th week - ").concat(e.key2))}))})):"yearly"===o.view&&n.map((function(n){e[n].forEach((function(e){t[n].push("".concat(fc[e.key1-1]," - ").concat(e.key2))}))})),t};return wp.element.createElement("div",{className:"helpdesk_dashboard_widget helpdesk_chart_wrapper vibebp_fomr"},wp.element.createElement("div",{className:"form_action"},wp.element.createElement("div",null,n.isAgent||n.isSupervisor?wp.element.createElement("select",{value:o.role,onChange:function(e){return a(ec(ec({},o),{},{role:e.target.value}))}},wp.element.createElement("option",{value:""},window.helpdesk.translations.selectas),Object.keys(window.helpdesk.settings.user_roles).map((function(e){return"agent"===e&&!n.isAgent||"supervisor"===e&&!n.isSupervisor?"":wp.element.createElement("option",{value:e},window.helpdesk.settings.user_roles[e])}))):""),wp.element.createElement("div",null,wp.element.createElement("div",{class:"buttons has-addons"},Object.keys(window.helpdesk.settings.chart_views).map((function(e){return wp.element.createElement("button",{className:o.view==e?"button is-success is-selected":"button",onClick:function(t){a(ec(ec({},o),{},{view:e}))}},window.helpdesk.settings.chart_views[e])})))),wp.element.createElement("div",{className:"select_time_difference"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("label",null,window.helpdesk.translations.select_dates),wp.element.createElement("input",{type:"text",ref:function(e){e&&flatpickr(e,{altInput:!0,weekNumbers:!0,defaultDate:[o.start,o.end],mode:"range",onChange:function(e,t,n){if(2===e.length){var r=ec({},o);r.start=e[0].getTime(),r.end=e[1].getTime(),a(r)}}})}})))),wp.element.createElement(vc,{getting:l.getting,config:f}),l.getting?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"")};var bc=null,vc=function(e){var t=cc();return lc((function(){if(Chart&&e.config){null!=bc&&bc.destroy();var n=t.current.getContext("2d");bc=new Chart(n,e.config)}}),[e.config]),wp.element.createElement("canvas",{style:{display:e.getting?"none":"block"},ref:t})},yc=wp.element.render;document.addEventListener("component_loaded",(function(e){"forums"===e.detail.component&&setTimeout((function(){yc(wp.element.createElement(kl,null),document.querySelector("#forums_component"))}),200)}),!1),document.addEventListener("vibe_helpdesk_stats",(function(e){document.querySelectorAll(".wplms_dashboard_helpdesk_stats").forEach((function(e){yc(wp.element.createElement(Zl,null),e)}))})),document.addEventListener("vibe_helpdesk_resolution_chart",(function(e){document.querySelectorAll(".wplms_dashboard_helpdesk_chart").forEach((function(e){yc(wp.element.createElement(dc,null),e)}))})),document.addEventListener("vibe_projects_tab_change",(function(e){"project_forum"==e.detail.tab&&document.querySelectorAll(".project_tab_content.project_forum").forEach((function(t){yc(wp.element.createElement(Ul,{detail:e.detail}),t)}))})),document.addEventListener("fullcourse_external_tab",(function(e){"course_forum"==e.detail.tab&&document.querySelectorAll(".course_forum").forEach((function(t){yc(wp.element.createElement(Ul,{detail:e.detail}),t)}))})),document.addEventListener("wplms_course_admin_tab",(function(e){"course_forum"==e.detail.tab&&document.querySelectorAll(".wplms_course_admin_tab_course_forum").forEach((function(t){yc(wp.element.createElement(Ul,{detail:e.detail}),t)}))})),document.addEventListener("group_tab",(function(e){"group_forum"==e.detail.tab&&document.querySelectorAll("#group_forum").forEach((function(t){yc(wp.element.createElement(Ul,{detail:e.detail}),t)}))}))})();